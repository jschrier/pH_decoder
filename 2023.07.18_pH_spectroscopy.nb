(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    174361,       4051]
NotebookOptionsPosition[    165695,       3902]
NotebookOutlinePosition[    166186,       3920]
CellTagsIndexPosition[    166143,       3917]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Import Data", "Section",
 CellChangeTimes->{{3.8986865423033247`*^9, 
  3.898686544423237*^9}},ExpressionUUID->"41bfdf1c-cbae-498c-b0ba-\
4ef64f7ba1eb"],

Cell["\<\
Use a local copy of the data provided by Christelle Ekosso on 06 July 2023, \
via Slack.\
\>", "Text",
 CellChangeTimes->{{3.8987016484618073`*^9, 3.898701653997036*^9}, {
  3.898701711198078*^9, 3.8987017340766897`*^9}, {3.898702092249419*^9, 
  3.898702093761853*^9}},ExpressionUUID->"4815a82b-fa12-4ff9-8213-\
9f53b7e54dc4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeedRandom", "[", "1841", "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"set", " ", "a", " ", "random", " ", "seed", " ", "for", " ", 
    RowBox[{"training", "/", "test"}], " ", "set", " ", "generation", " ", 
    "for", " ", "replicability"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<src/platereader.wl\>\""}]}], "Input",
 CellChangeTimes->{{3.898684411303891*^9, 3.898684432201079*^9}, {
  3.8987018813207407`*^9, 3.898701896012442*^9}},
 CellLabel->
  "In[388]:=",ExpressionUUID->"8ff1613a-309d-4d85-a065-e5221190e944"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Short", "[", 
   RowBox[{"spectra", "=", 
    RowBox[{
    "importPlateReaderFile", "[", 
     "\"\<data/Universal Indicatory Array.txt\>\"", "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"measuredpH", " ", "=", " ", 
  RowBox[{"Import", "[", "\[IndentingNewLine]", 
   RowBox[{
   "\"\<data/Copy of Universal Indicatory Array.xlsx\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<Data\>\"", ",", "2", ",", 
      RowBox[{"3", ";;", "40"}], ",", "4"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<EmptyField\>\"", "->", "Nothing"}]}], " ", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.898684437154305*^9, 3.8986844608803787`*^9}, {
  3.898684761034972*^9, 3.898684765754644*^9}, {3.898685055665476*^9, 
  3.8986850766721783`*^9}, {3.898685115896261*^9, 3.898685136687943*^9}, {
  3.898685189528648*^9, 3.898685206551504*^9}, {3.8986852401601763`*^9, 
  3.8986853291350822`*^9}, {3.898701751269945*^9, 3.898701758357234*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"b10ec20e-4824-43de-84fb-c506e6068098"],

Cell[BoxData[
 TagBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"350", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "0.71075`", ",", "0.67575`", ",", "0.10975`", ",", "0.17575`", ",", 
       "0.13475`", ",", "0.21875`", ",", 
       RowBox[{"\[LeftSkeleton]", "84", "\[RightSkeleton]"}], ",", 
       RowBox[{"-", "0.03625`"}], ",", 
       RowBox[{"-", "0.03525`"}], ",", 
       RowBox[{"-", "0.03325`"}], ",", 
       RowBox[{"-", "0.02325`"}], ",", 
       RowBox[{"-", "0.03225`"}], ",", 
       RowBox[{"-", "0.03325`"}]}], "}"}]}], ",", 
    RowBox[{"\[LeftSkeleton]", "40", "\[RightSkeleton]"}]}], "}"}],
  Short]], "Output",
 CellChangeTimes->{
  3.89868446175168*^9, 3.8986847660289288`*^9, 3.898685138208562*^9, {
   3.8986852005108633`*^9, 3.8986852068389273`*^9}, 3.898685260735186*^9, {
   3.898685304026135*^9, 3.898685329482099*^9}, 3.898702082442149*^9, 
   3.898702231470332*^9},
 CellLabel->
  "Out[391]//Short=",ExpressionUUID->"8a64bf13-c246-4f35-b45d-25a39301ed38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.75`", ",", "4.72`", ",", "4.87`", ",", "5.28`", ",", "5.5`", ",", "5.8`",
    ",", "6.14`", ",", "6.81`", ",", "7.3`", ",", "7.55`", ",", "7.8`", ",", 
   "8.03`", ",", "8.12`", ",", "8.27`", ",", "8.33`", ",", "8.7`", ",", 
   "8.77`", ",", "9.21`", ",", "9.11`", ",", "9.41`", ",", "10.61`", ",", 
   "10.27`", ",", "11.66`", ",", "11.44`", ",", "11.23`", ",", "11.72`", ",", 
   "11.92`", ",", "12.16`", ",", "12.17`", ",", "11.9`", ",", "12.15`", ",", 
   "12.2`", ",", "12.21`", ",", "12.32`", ",", "12.16`", ",", "11.94`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.89868446175168*^9, 3.8986847660289288`*^9, 3.898685138208562*^9, {
   3.8986852005108633`*^9, 3.8986852068389273`*^9}, 3.898685260735186*^9, {
   3.898685304026135*^9, 3.898685329482099*^9}, 3.898702082442149*^9, 
   3.898702231540107*^9},
 CellLabel->
  "Out[392]=",ExpressionUUID->"738dcff2-6385-4e5f-ad50-dad829045876"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"createDataset", "[", 
    RowBox[{"spectra_List", ",", "pH_List"}], "]"}], ":=", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"spectra", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2", ",", "i"}], "]"}], "]"}], "->", 
       RowBox[{"pH", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ")"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", 
       RowBox[{"Length", "[", "pH", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"createDataset", "[", 
    RowBox[{"spectra", ",", "measuredpH"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wavelengths", "=", 
   RowBox[{"spectra", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.898685343319233*^9, 3.898685366684609*^9}, {
  3.898685412222457*^9, 3.898685469798463*^9}, {3.898685503166106*^9, 
  3.898685614797386*^9}, {3.8986856500850067`*^9, 3.8986856618776627`*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"dd4d6e42-867a-4aa9-8329-2ebc0d0b79b9"],

Cell[CellGroupData[{

Cell["Visualize a sample", "Subsection",
 CellChangeTimes->{{3.898686551135249*^9, 3.898686553719262*^9}, {
  3.898686826086689*^9, 
  3.8986868279741*^9}},ExpressionUUID->"74c51757-cb74-4072-8f7a-3cf6412c4647"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "10", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "15", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "20", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "25", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "30", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "35", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "1", ",", "5", ",", "10", ",", "15", ",", "20", ",", "25", ",", "30", 
         ",", "35"}], "}"}], ",", "2"}], "]"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DataRange", "->", 
    RowBox[{"MinMax", "[", "wavelengths", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<Wavelength (nm)\>\"", ",", "\"\<Abs\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.898684769402519*^9, 3.898684809769553*^9}, {
   3.898684860713766*^9, 3.898684895001308*^9}, {3.8986849257620296`*^9, 
   3.8986849494411097`*^9}, {3.898684991617017*^9, 3.898685016320856*^9}, {
   3.898685674254675*^9, 3.8986857117008963`*^9}, {3.8986863076650133`*^9, 
   3.898686310024603*^9}, 3.8986863958304787`*^9, {3.8986864415848417`*^9, 
   3.8986864951279907`*^9}, {3.89868655532824*^9, 3.8986866172796497`*^9}, {
   3.89868668096054*^9, 3.898686760136207*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"cef8418b-1cb4-4a84-91ef-ecb660a027c0"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0iLLecKNv3zB7MbyhzSLG+7987HcpXKHdw
Snh6Qek2lH+g3CFfqPnAqYXPIfyECoczyWdPKHx/AeEzVDoYnTLWb499BeEv
qHTIrvuz1PXvawjfocrh+8ToyXmn30L4D6oclsf6GN/Nfge1v9ohoHd6nlDz
e6j9NQ5SfjNn57N8gNpf4xCzri5nUjyUn1Dr4CNx9tS3RCifoc5hm9Au70c5
UP6COoclBbZc1xdD+Q71Dh3fZSL6LkD5D+odursXFwl/hck3OOSw7VCIvgbl
T2hwiC1gq98fAVPf4PAyZeXXOmWo+wwaHeZHLD/1nQfm/kaHfXcnyWzQfgPh
X2h06Ki/cWmxJjR8FJoceI9smul86TGEX9DkkCQAioEHUP81OfhxdnjumHAP
whdodsjf+WujZ91dqH+bHRafPCoRcfwOhL+h2eHiyaDXf92gfIYWh5dqhhxr
ZKD8gBYHLWb2LSWsUP6CFoc1MlHAKL4N4X9ocWiWDN5w7CaU79DqcH0xKMCg
/Amt0PQB5T9odQDFvus2KN+gzeFgoaS56QUov6HNQbzB7eWl/VD+hTYHJ/bY
Qwu3Q/kK7Q6RD7R3fZ0F5Re0O8zIAyWo2/YANfTfLw==
         "]]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh2KMya+rbE/aA/mN5Q5dOc8/73y4yEIX6Hc
YUaeUPOBU0ch/AMw/kkIP6HCQTgh4l9N9DkIn6HSwXS7U0Sv6kUIf0GlA5eB
Tv0+3csQvkOVQ5/dM2amuVcg/AdVDp6pXZYcVleh9lc7xO3y5GHShvIVahwe
KfbMP7YXqv5AjcNGyQdNOZFQ8xJqUe1jqHPw1M/6vprhLNT+Ood/Vypeqhme
gNpf78BqvCyhd/NhqP31Dn+/P9jqLX0AKt/g0N5uUCf1fReEP6HBIeVU+4Ks
L9ug6hsc9P1qti622AzhGzQ6fJCQ+x2psxHq/kaH0tLjSbND1kD4FxodnrR7
Kad9Wwj1T5ODhQ7vnxVtvRB+QZPDn5UfL/kmOeyH+K/JoVp/X0a/eBGEL9Ds
cPMle+lEp0oIPwHI3/zcyJSzDsLf0OwQEXLkpUp0LYTP0OKg3S5289z3Zgg/
oMVhZab4ZZ/vXRD+ghYHH/NOx4SnEyD8Dy0OTzJ/Nq62mQjhO7Q63P5Zl7Wn
ZDKEP6HVAcSRYJkG4T9odagWWef+sGoKhG/Q5nDbVHGt4Qsov6HNQSq7Pr36
C1T9hTaHU3ef/8gohPIV2h0OGZ6ex2I2HcIvaHcI2iHX+jpwxn4A4nDabw==

         "]]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0mvq2xN417ag/mN5Q5xO3y5GHSfg7hK5Q7
VIusc39Y9RLCP1DuMCNPqPnAqdcQfkKFw6sXO6Ruir6D8BkqHf5mVz6tin4P
4S+odOhSWpKXLv8BwneoctgwUYUjnAHKf1DlIP0xxdy4Cqq+odrh5rnvwY+X
Qs1TqHFQkizKsT38Fmp/jYO17ImqrNI3UPtrHe7sZqt9mfsKan+dg6dXlUSU
7Auo/XVQ90L951Dv4PtTIKT33mOo/fUOfNla3YfWPYLKNzjUrTBJSpOH8ic0
OAT6yzfa10D5Dxocnlsq3V8aAtVv0OjQonlq6cfuJ1D3NzoEK8p1Tld/BuFf
aHToXhX/suYHLDybHFTmNk6cvhUangVNDtOcu3Oe/4aG54Emh42306fODIL6
X6DZgTHzP/Oaq9DwSWh2iJ/dO3WGOjT8NjQ7POWbfeJMKyz8WxycEp5eULoN
DY+AFqg81D0LWhy028WAQfwQwv/Q4rDnrLR6a+U9qP9bHV6qGXKskbkF9X+r
g/Ltn3VZe25A/d/qsKEoA5hkrkP93+aw4OCyc4sfXYP6v83h2/nLDY6XoPwL
bQ7n552+olIB5Su0Ozwrn3WmIhrKL2h3qM/aUzJZ4po9ACyZ3qk=
         "]]}, {
        Hue[0.37820393249936934`, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh1aXwfukGs9bg/mN5Q5NE517s55fhrCVyh3
2DT3/fJj3hch/APlDiGPl84+onAFwk+ocEiwizSMkb0O4TNUOkx0Y/Xb1ngD
wl9Q6aASz7nkyDoo36HKQXL12f+r+6DqH1Q5TC7sSekPuAa1v9oh4ekFpds/
oeYr1DhMe8UUl3bjMtT+GoedR//cuTDlEtT+WgdL3sBW+8MXoPbXOfi2VqjE
zTsDtb/OYRnQtRuKTkDtr3dY+P2YAIPMUaj99Q4NO1aHT7x4GCrf4KD0L9G7
f9kRCH9Cg0O042Uh7cXQ8HnQ4LB48tJrv3uh5hs0OsQnHvzbwA4Nn4ZGh9Uz
vOwfvoG690Kjw9lil33eK6H+U2hy2PStfJt7/k0Iv6DJwce80zHh6R2o/5oc
5uoqbJGzewDhCzQ7vH9qZ8k14SHUv80OeiWqTFf3Q/kbmh2ubEsUYeGHqmdo
gcYX1PyAFocPfna221Kh7lvQ4nC14qWaIQfUfx9aHDRfmwtfbt0C9X+rgyRL
GJ/uprlQ/7c6VIKUr8mB+r/VYZcnD5N2e9t+iP/bHGYzHP70/PYkCL+hzUEq
uz69+ss0CP9CmwOXsNvmTbUzIHyFdoeFjRFmxR6zIPyCdoeJb2vsTeNm7QcA
efHXzg==
         "]]}, {
        Hue[0.6142719099991583, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0st5wo2zf/hj2Y31DmkCQQARS6B+ErlDuc
BMpK6T+C8A+UO2RMfFtjb/oEwk+ocPg/jeFPsBaUz1DpsJ4zs9dxOVT9gkqH
+JqLcvoqDyF8hyqH7OQ3LdMf3IfwH1Q5vKzfKabrALWvodph09z3y49534Xa
X+Nw73RtkYgClH+gxsEtNvt9cCiUn1DrwLJ+mrXxQSifoc4htEu21/kvlL+g
ziEqxfq+fy/UPod6B/73lhtkFkLd86DeQeHdq9CUL1D3OzQ43OtlbXWUfAnh
T2hw+O3w6dzCnndQ9Q0OprVlB0pbP0P4Bo0OC1OKstIjvkPd3+hwTkwgin8+
lH+h0WHZrobpkt8+Qf3T5HAm+ewJhe9vIfyCJodls48obCh6BfVfk8OdpLq8
DC8oX6DZIcnvglr7eSg/odnhCv8rpVYjKH9Ds8P6DQ/qDjQ/h/q/xeHwV42Y
/kPQ8A9ocbiz4Fu0deBtaHi0OIisc39YJXIJwv/Q4hB6wPb8fLMTUP+3OoQ8
Xgp00QGo/1uh7tsB9X+rg3a72M1z3zdD/d/mYBOw3GaX4Cao/9sc5phWxE/l
3gj1f5vDjyNWofvSN0D93+6wJOhNhsyr9VD/tzuskQHF0Hp7AD6124g=
         "]]}, {
        Hue[0.8503398874989481, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh2e/1758ZLvBXswv6HMQXfT3PfLj12G8BXK
HeRbXwfukLsO4R8od8gXaj5wauFNCD+hwuGp5uqXVYtuQfgMlQ76ZmtFmHZC
5RdUOmg9mPfcX/oGhO9Q5aB+o37ubLNrEP6DKgf/Z/K1k5ddgdpf7VBoy3V9
cQHM/hoHr82VMmyfL0Htr3Hgv6LZn9cC5SfUOjS8Oz3zLReUz1DnYNAy5/v/
wotQ++sc5hxR2FCUAeU71DuoxHMuObIOqv5BvcPhOQt8+eZfhco3OIiG7r/0
8wPU/RMaHHS51f5pvLoPVd/g0KJ5aunH7icQvkGjQ6jP0vkF315A3d/ocGVb
oggL/ysI/0KjQ0F105Gy8mdQ/zQ5WJUFdL6e8RjCL2hy8DHvdEx4+gjqvyaH
CvX5crc3QeUFmh0uJAQ/DyyE2pfQ7PDqxQ6pm6JQ/oZmBwmnc7//73gI9X+L
g9u2z3+vVNyG8ANaHKyiHTJsa6D+XdDicLJs33wp/aMQ/ocWh8Izm9Qbz26F
+r/VYYccKMLnQf3f6lAtss79YVUK1P+tDpZbTgBN6NoP8X+bg7X0p/M8jyZD
+A1tDrta17ks+DUdwr/Q5rBKt3TC9eaZEL5Cu4PjnHbhGX6zIfyCdgdDjjUy
USmz9wMAqprfww==
         "]]}, {
        Hue[0.08640786499873876, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.363898, 0.618501, 0.782349], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0Snl5Quv3zlD2Y31DmENA7PU+o+QKEr1Du
8Pz3yo+XfK9A+AfKHW7/rMvaU3Idwk+ocJgtu3Lf5+6bED5DpcNN9YaklJNQ
/oJKByWTpt7X929A+A5VDidlzSbO5Ibqf1Dl8Dkstj3L6yrU/moH8Zvnvgc/
vgy1v8Zh3jT5HaeEofwDNQ57pbm5mo0uQe2vdXh4ec6eEywXofbXOdxxz/Pd
pXsean+dQ+lkCZYwvrNQ++sdfkczffBfeQZqf73DVrG0hXMvn4PKNzgcLJQ0
N70ANW9Cg4Mrfw1P2Byo+x40OHzws7PdlnobwjdodDBwU+HSzX4AdX+jw3/b
ireX2B5B+BcaHc5wue6af/kh1D9NDhUN6rox16D8giYHxQ1FGRPfQtUfaHKQ
yg0Vutn+BMIXaHaYeV2wPWfBU6h/mx3u7GarfZkL5W9odjA/vtN3x3WofoYW
B2MwuAvhB7Q43PB6ode5GRp+C1oc9pSAAuQYhP+hxWHHWl0bfdHtUP+3OkRY
bjlRtm8+1P+tDtUi69wfVqVA/d/qUPlSzZBjTc9+iP/bHKoCArrC3k2F8Bva
HGZetb7Dxzsbwr/Q5tBZy6ThNm0OhK/Q7vBw27YPe0Kg/IJ2h4tKoBQ1Zz8A
XXzYXg==
         "]]}, {
        Hue[0.3224758424985268, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[1, 0.75, 0], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh1Olu2bL6V/2R7Mbyhz2CHX+jpwxzUIX6Hc
YcUxb/NOx1sQ/oFyhw/LQQJ3IfyECodrVoWWcYwPIHyGSodPU66W2AZC+Qsq
HW6qNySlnLwP4TtUOVyTT5TY8ASq/0GVw+rSR0V7mO5A7a92uKh0+2ddFtQ+
hRqHaO7NF85l3oTaX+OguvZH26H0G1D7ax3crZiV9bOvQ+2vg6q/CrW/zuFq
xUs1Q44rUPvrHY4t2T/9UDPUvw/qHS6eDHr91w0m3+AwITNX6nY21P8TGhzy
srnPex+F2v+gwaGYn/P+b2mofwwaHeQOJ9t3qz6Cur/R4XW/AU/Ep8cQ/oVG
B9b9vIZxxU+g/mlyCF2qu+6j5FMIv6DJQRnk3T3PoP5rcjgSp5FgPeMFhC/Q
7PB213Ylw4Mvof5tdtho8mGxVBmUv6HZIcnvglr7eah+hhZofELdE9DiYNN2
vE7MGxqeC1ocZKNSrO/7X4TwP7Q4JB7KCNvGfxzq/1YHSZYwPt1Ne6H+b3UA
mXZXZRvU/60ObwJBKWQj1P9tDitW/Jp6rn091P9tDpnFc263VK+F+r/NQXGS
4vFrxmug/m93UH2h/6Xj4mqo/9sdau1N43Z5rrEHAAQf11E=
         "]]}}}, {{}, {{}, {}}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {341.6666666666674, 0}, 
     DisplayFunction :> Identity, Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{
        FormBox[
         TagBox["\"Abs\"", HoldForm], TraditionalForm], None}, {
        FormBox[
         TagBox["\"Wavelength (nm)\"", HoldForm], TraditionalForm], None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
       "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
       "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{341.6666666666674, 750.}, {-0.027917, 1.476333}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.08090169943749476]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "4.75`", "5.5`", "7.55`", "8.33`", "9.41`", "11.23`", "11.9`", 
       "12.16`"}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #6}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #7}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #8}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.528488, 0.470624, 0.701351]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.772079, 0.431554, 0.102387]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.363898, 0.618501, 0.782349]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|"color" -> RGBColor[1, 0.75, 0]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5, ",", #6, ",", #7, 
               ",", #8}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "True", ",", "True", ",", "True", ",", "True", ",", "True", 
                 ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.898684927695025*^9, 3.89868494980886*^9}, {
   3.89868499225063*^9, 3.8986850165232143`*^9}, {3.898685695966176*^9, 
   3.8986857121428556`*^9}, 3.898686310708688*^9, 3.898686398238966*^9, {
   3.898686445752841*^9, 3.898686495671712*^9}, {3.898686557766159*^9, 
   3.89868658822338*^9}, 3.898686618743683*^9, {3.898686698228057*^9, 
   3.89868676113758*^9}, 3.898702082641274*^9, 3.898702231656828*^9},
 CellLabel->
  "Out[396]=",ExpressionUUID->"13a56737-c31a-4c7b-8836-cd4686ba8b26"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Comment:  ",
  FontWeight->"Bold"],
 "It doesn\[CloseCurlyQuote]t appear that there is a consistent baseline (\
\[OpenCurlyDoubleQuote]zero\[CloseCurlyDoubleQuote]) for these spectra, which \
might cause problems later.  Let\[CloseCurlyQuote]s take a look at the first \
3 spectra, which are pretty close in pH and illustrates the \
\[OpenCurlyDoubleQuote]wandering baseline\[CloseCurlyDoubleQuote] problem:"
}], "Text",
 CellChangeTimes->{{3.898691577892146*^9, 3.898691609995902*^9}, {
  3.898691646124339*^9, 3.898691660684307*^9}, {3.898691786900238*^9, 
  3.8986917986366053`*^9}, {3.8986926878447742`*^9, 
  3.898692713115999*^9}},ExpressionUUID->"dd48f216-ab0c-44a6-9b7c-\
0887d2ca7c1b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"data", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "2"}], "]"}], "]"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"DataRange", "->", 
    RowBox[{"MinMax", "[", "wavelengths", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<Wavelength (nm)\>\"", ",", "\"\<Abs\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.89869156376551*^9, 3.898691573237032*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"51e6fb90-14c8-4107-a5df-413c27bbe62e"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0iLLecKNv3zB7MbyhzSLG+7987HcpXKHdw
Snh6Qek2lH+g3CFfqPnAqYXPIfyECoczyWdPKHx/AeEzVDoYnTLWb499BeEv
qHTIrvuz1PXvawjfocrh+8ToyXmn30L4D6oclsf6GN/Nfge1v9ohoHd6nlDz
e6j9NQ5SfjNn57N8gNpf4xCzri5nUjyUn1Dr4CNx9tS3RCifoc5hm9Au70c5
UP6COoclBbZc1xdD+Q71Dh3fZSL6LkD5D+odursXFwl/hck3OOSw7VCIvgbl
T2hwiC1gq98fAVPf4PAyZeXXOmWo+wwaHeZHLD/1nQfm/kaHfXcnyWzQfgPh
X2h06Ki/cWmxJjR8FJoceI9smul86TGEX9DkkCQAioEHUP81OfhxdnjumHAP
whdodsjf+WujZ91dqH+bHRafPCoRcfwOhL+h2eHiyaDXf92gfIYWh5dqhhxr
ZKD8gBYHLWb2LSWsUP6CFoc1MlHAKL4N4X9ocWiWDN5w7CaU79DqcH0xKMCg
/Amt0PQB5T9odQDFvus2KN+gzeFgoaS56QUov6HNQbzB7eWl/VD+hTYHJ/bY
Qwu3Q/kK7Q6RD7R3fZ0F5Re0O8zIAyWo2/YANfTfLw==
         "]]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0st5wo2zf/qT2Y31Dm4MXDpN0uBuUrlDuc
PQMCUP6Bcgd1Q441MlHPIPyECofsuj9LXf9C5RkqHT5NuVpiG/gCwl9Q6bDR
5MNiqbKXEL5DlcOJLWa9b01fQfgPqhxKQxeINbO/htpf7bDIddvnv1egfIUa
h36GPDH9aVD+gRoHy08OKROXvYHaX+sww2DW1LeHoXyGOgep3FChm+1Q/oI6
hx/Bj5fOPgLlO9Q7HH1k3jq1C8p/UO+wsFnv4YXbMPkGh+5V8S9rfkD5Exoc
3gg7GG56ArX/QYND1q83Da+5oHyDRoe5ugpb5Oyg/mlohMpD/X+h0cH/NH/M
005YeDY5zIpWXHNs0iMIv6DJ4WGVyDr3h/eg/mty8LnHYHz/IJQv0OxweM4C
X775d6H+bXb4HBbbnuUF5W9odpDXSXY2/30H6v8Wh97peULNB6D8gBYHo/XK
fDcdbkPDo8VhSYEt1/XFUPkPLQ41M/bmWOdC+Q6tDqDQUthwC+r/VocZIONO
Qe170AqNf6h6gzYHwf8blroHQ/kNbQ78VzT781qg/AttDi5GT25UtUHtV2h3
+Hb+coPjJah8QTvcvQBl8t9O
         "]]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh3qs/aUTJbYYw/mN5Q5nCzbN19Kfy+Er1Du
UGtvGrfL8wCEf6DcwXLLCaCKQxB+QoWDaPd9kTCtYxA+Q6XDCY3ze2TKTkL4
Cyod1B5LnJRbeAbCd6hyaHpslJe14DyE/6DKQa1rwq65tReg9lc7gGzjYboI
tb/GgTN4ivdjcSj/QI3D2WKXfd4roeoTah2aim7vc/8LNY+hzmGCwFPuKI9z
UPvrHBQ3FGVMfAuzv94h/PWRpxWsUP6Deodrx25w6h88DZVvcOhIObHxKw+U
P6HB4X3k9QzLC1D/PGhwaOHb1eKcfxzCN2h0eOk588oFNqj/GxodzNas1OHa
DQ2fC40OfpfT2WPCd0D90+SgvTS9qnPjEgi/oMmh8qWaIceaHKj/mhx2Hgxo
F83r3A/mCzQ7hMh73LOcMhHCT2h2KNZ5v4r9zGQIf0Ozg3H+1dIVy6ZA+Awt
DsVA39bYT4XwA1ocLnWyBJ9dA+UvaHFY9fGSb5LADAj/Q4sD8/snl5Ojp0H4
Dq0OUSnW9/17p0P4E1odvHiYtNvFZkL4D1odftWBEgxUv0Gbw67WdS4LfkHV
N7Q5RC24q3iUAar+QpuDp8eS3D+dsyB8hXYHxzntwjP8ZkP4Be0OQM/LRKXM
3g8AUhvXSg==
         "]]}}}, {{}, {{}, {}}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {341.6666666666674, 0}, 
     DisplayFunction :> Identity, Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{
        FormBox[
         TagBox["\"Abs\"", HoldForm], TraditionalForm], None}, {
        FormBox[
         TagBox["\"Wavelength (nm)\"", HoldForm], TraditionalForm], None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
       "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
       "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{341.6666666666674, 750.}, {-0.02675, 1.059833}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.08090169943749476]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{"4.75`", "4.72`", "4.87`"}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "72"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "72"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "72"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.898691573797901*^9, 3.898702082759192*^9, 
  3.8987022317688704`*^9},
 CellLabel->
  "Out[397]=",ExpressionUUID->"3c70c2c3-43f8-49ae-9fd9-858d3825f656"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Comment:  ",
  FontWeight->"Bold"],
 "It may be valuable to normalize the spectra in some way; this will be \
essential for the earthmover distance calculation.  We will revisit this \
below."
}], "Text",
 CellChangeTimes->{{3.898692716859757*^9, 3.898692742820299*^9}, {
  3.898703426103853*^9, 
  3.898703431646942*^9}},ExpressionUUID->"f4bacee1-9bea-4acf-9daa-\
20ef0e2f3f49"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualize the blanks", "Subsection",
 CellChangeTimes->{{3.89868695203041*^9, 
  3.898686957366336*^9}},ExpressionUUID->"ea0c463e-3d23-4dfd-8556-\
6140c0a2da85"],

Cell["\<\
The last row of wells in the 96-well SBS plate are a water blank, as \
described on Sheet 2 of the spreadsheet.\
\>", "Text",
 CellChangeTimes->{{3.898703437726365*^9, 3.898703450062603*^9}, {
  3.898703490734256*^9, 
  3.898703506950231*^9}},ExpressionUUID->"3e986cfb-1dd9-4fd4-9fb8-\
984250747ed5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"spectra", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2", ",", 
        RowBox[{"-", "12"}]}], "]"}], "]"}], ",", 
     RowBox[{"spectra", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2", ",", 
        RowBox[{"-", "9"}]}], "]"}], "]"}], ",", 
     RowBox[{"spectra", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2", ",", 
        RowBox[{"-", "5"}]}], "]"}], "]"}], ",", 
     RowBox[{"spectra", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2", ",", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DataRange", "->", 
    RowBox[{"MinMax", "[", "wavelengths", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<Wavelength (nm)\>\"", ",", "\"\<Abs\>\""}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.898687021790654*^9, 3.898687138197884*^9}},
 CellLabel->
  "In[398]:=",ExpressionUUID->"f4abb5b8-c588-4acf-afbd-dabf3b236061"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh2WFNhyXV88YT+Y31DmcPtnXdaekskQvkK5
w6dLvkkCETMh/APlUPULIPyECocPnaWras5D+QyVDi650m6OH6D8BZUOMwIO
PmQVXAjhO1Q5hDB+t6m/BZV/UOXgcViz+HMvlN9Q7RDQOz1PqBnKV6hBVX+g
xmHDhJ1GK8xg9tc6fLnffF0vF2Z/nUPMWuHpj0Vh9tc5/Fn5EegDKN+h3sFj
6Y2LFlfmQ+2vdxCYcvub7Sso36EB1fwJDQ4/TCexPOSCubfBgaUk/lxOOJRv
0OiQcbZ//5YVUP0Njaj6L6DJKzQ5/BB3TFYLhPILmhw41shEpVhD+QeaUN0v
0IzqvoRmVPdsaHaICGfNMqyA+b/FYUNRxsS3NVD1AS0OBZVrJCWfzIOGR4tD
yOOls48oQNV/aHFYcK9n1vpJMP+3OkRYbjlRtg/Kn9CKGt8PWlHD06AN1b0N
bQ5rrFazfpsB83+bw2dpNaklD6Dxr9Du0P/A7ZSY52Ko/9sd2sVunvsevHg/
ACfZ6V4=
      "]]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0Snl5Quv1z3n4wv6HM4c/Kj5d8kxZA+Arl
DjPyhJoPnFoI4R8odwBxXLcthvATKhz0919OOXZ7EYTPUOnQvKiSofsPlL+g
0qH9R7uu7Swo36HK4bO0mtSSB1DzHlQ5WGR/2KclDpVvqHawN43b5ckD5SvU
oKo/UOMQsPoF/1kbKD+h1sElV9rN8QPUvQx1Dn+OO5VwyEDlF9Q5zDmisKEo
A8p3qEdV/6DeISKcNcuwAsp3aHBgkAtcuGsnlD+hwWFGwMGHrIIw9zY4hDB+
t6m/BZU3aHRgKYk/lxMO5Tc0ouq/0IiqXqHJwUfSYsFSbSi/oMlhSYEt1/XF
UP6BJoc1VqtZv82A8gWaUd2X0OzgcViz+HMvlL8BTZ6hxWHFMW/zTkcoP6DF
QWDK7W+2r+ZDw6MF1b4PLQ4L/ty1zvKB+b8VNf4ntKKqf9Dq4AM0PeEpzP9t
qO5taEMN/wttDs4r93ZsS4bFZ7tD/wO3U2Ke0PRT0O5wfTHYgv0A7AnhdA==

      "]]}, 
    {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh3sTeN2efIs2g/mN5Q5WN/3752eB+UrlDuY
dzomPL0A5R8odzAGg8UQfkKFQ71P9uUbcVA+Q6WDseijiRWVUPULKh3af7Tr
2s6C8h2qHD5Lq0ktebAQwn9Q5fDibkSAxBQov6Ea1T0KNQ5L+vpWT4yFyh+o
cQhY/YL/rA2Un1Dr4JIr7eb4YQHU/jqHNVarWb/NgPIX1Dn4gD0A5TvUO3y5
33xdLxfKf1DvEBHOmmVYAZNvcGCQC1y4ayeUP6HBweOwZvHnXpj6BocQxu82
9begfINGB5aS+HM54VB+Q6PDhgk7jVaYQfkX0OQVmhx8JC0WLNWG8guaHEIe
L519RAHKP9CE6n6BZlT3JTQ7/DCdxPKQC8rfgCbP0OKw4pg30MdQfkCLg8CU
299sX82HhkcLqn0fWhwW3OuZtX4SVN6h1eHPyo+XfJNg/m91WFJgy3V9Mcz/
aPIGbajubWhz+HPcqYRDBho/F9pQ41uh3aH/gdspMU9oeilod2gXu3nue/Di
/QA+8uCB
      "]]}, 
    {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0WSOnfVWFbuB/MbyhzmHNEYUNRBpSvUO5g
3umY8PTCIgj/QLlD84FTC123LYbwEyoc6n2yL9+Ig/IZKh2aF1UydP+Bql9Q
6XC9VX6OvyxU3qHKwXnl3o5tyVD5B1UOFtkf9mmJQ/kN1Q72pnG7PHmgfIUa
h8/SalJLHkDdc6DGYYFFQ939/VB+Qq3DlF+btgQXQ/kMdQ5/jjuVcMhA+Qvq
UP3jUO/gkivt5vhhAdT+eocVT+bccP4N5Ts0OASsfsF/1gaqfkKDw4yAgw9Z
BaH8Bw0OIYzfbepvQdUbNDqwlMSfywmH8hsaHRjkAhfu2gnlX2hEVa/Q5DBn
2Xm+Heug/IImhyUFtlzXF0P5B5pQ3S/QjOq+hGYHj8OaxZ97ofwNaPIMLQ4/
gh8vnX0Eyg9ocYgIZ80yrIDyF7Sg2vehxWHBn7vWWT4w/7c6/Fn58ZJvEpQ/
odXhy98rFS/VYP5vdfABJwiY/9tQ3duAxr/QhhrfCu0O/Q/cTol5QtNDQbvD
9cVgB+0HABeV6QY=
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{341.6666666666674, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"Abs\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"Wavelength (nm)\"", HoldForm], TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{341.6666666666674, 750.}, {-0.03875, 0}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.898687097786076*^9, 3.8986871388801727`*^9}, 
   3.8987020828417253`*^9, 3.89870223184765*^9},
 CellLabel->
  "Out[398]=",ExpressionUUID->"d26c1a07-accc-4e6f-8764-f5ec270f4d2f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approach 1:  Principal Components Analysis", "Section",
 CellChangeTimes->{{3.898684977072363*^9, 3.898684989104004*^9}, {
  3.898703515061996*^9, 
  3.8987035156063223`*^9}},ExpressionUUID->"eb37714b-2f62-455e-8a4b-\
ccbbb3b3df22"],

Cell["\<\
Perform principal components analysis to reduce the dimensionality of the \
problem, then use either linear regression or a nearest-neighbor model to \
assign the pH.\
\>", "Text",
 CellChangeTimes->{{3.8986881740909033`*^9, 3.898688225154965*^9}, 
   3.898688910759054*^9},ExpressionUUID->"33ec8577-5af7-49a3-8353-\
ca3cd3d1f24d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pca", "=", 
  RowBox[{"DimensionReduction", "[", 
   RowBox[{
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"Method", "->", "\"\<PrincipalComponentsAnalysis\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transformedData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"pca", "[", 
        RowBox[{"entry", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
       RowBox[{"entry", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"entry", ",", " ", "data"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.898687222669746*^9, 3.898687269669746*^9}, {
   3.8986873582064867`*^9, 3.898687361317307*^9}, {3.898687676517584*^9, 
   3.89868768741341*^9}, 3.898688203332033*^9, 3.898688558023147*^9},
 CellLabel->
  "In[399]:=",ExpressionUUID->"f6e12f12-dbc5-4737-8b74-feb5aec1c4f5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["DimensionReducerFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{{{{}, {}}, {}, {{}, {}, {
                 GrayLevel[0.7], 
                 AbsoluteThickness[1.8], 
                 Opacity[1.], 
                 LineBox[CompressedData["
1:eJwB8QEO/iFib1JlAgAAAB4AAAACAAAAAAAAAAAAAAAAAAAAAAAAAA3l5opg
ldw/ifaD+DItuD+MkCEodiHjP9qvjCs8v9E/bLbqGG2J5D+WRNoAzOrePxWI
hjT6cuM/qFFV1TM75j8YmI/Y7IHfP/eKfiNPOe0/quVYmD5o1D+ADmRmEGnx
P3eNjU0+TbI/IY3cLB+l8z/z/SDb3KDLv5a/pk3oyvQ/P80MS7g64L+H2H4K
a8b0P9+nsKVohOq/rTamnQZ68z/qrFzHBdfxv6YHIajkDPE/bw9qE5vX9b+Z
SUCP/i3rP/uMEvTgV/m/kzjs/r2F4T/bUNnDc5T7v9G7+cvEhMs/wYIqip+q
/L9jvEi/XoXHvxhoDlvsO/y/eOnDDXz84r8s6yb5EW/6v2qTREHJFe+/UEHO
hnD69r/GEyuZBq31v4JWinxOcPK/c9vQT8is+r8XVSwtro/ov0knBpVW9/6/
yZ09iVcE1b9l2NyAUeAAwDbV0T76Ar4/Y701SKBwAcCmV9X1r7fjP9Pdwu5B
LgHAhEmFnNot8T/aVnzNXBkAwIeJGWTe4Pc/Fl/LTVCK/L9n/YLkNTv+P27f
ThBa+/a/DjFFsd98AUAQoc+DuIDwv00y1JUAQgNAdLxOLvHB4L8FJ/Yfkw0E
QHdYowipHsa8z+n67g==
                  "]]}}, {}, {{{}, {}, {}, {}}, {}}}, {{{}, {}}, {}, {{}, 
                GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQvSOde+X6LwX2L+JEV934or//a9ba9rVPHto/qNs+
h/vZZfumRXKlmjWP7f94fAgTnPDcnk/kyM/O5Bf27XmKKav2f7HfXXOp8OzR
U/ZfddfwhpR8tH/Mf1NimfrD/bmrPms6/Ptsv6/iJO/vs5/3+3H82Z7G+Nqe
6/yMbVMP/dhfKsm+/u3U5/bzr9z7quHMeMBGKvy71POz+5PZdsQbTf23/7d6
VqJF6pf9/teV3u88/Hn/ux/vv2b//bTftGfJ25NKr/eXHb7jHVj0Y39nSUKD
+sIl9od7wyt357EeyI75vbEl+Jl9xCWXx0L8f/a7XHD6XCLA4HD6j8KD5/N+
7l/dca7ELo3ZwUXo+W6J9/f2j3T/AwAmeB/L
                 "], {{}, {
                   GrayLevel[0.5], 
                   PointSize[0.12], 
                   AbsoluteThickness[1.6], 
                   
                   PointBox[{17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
                    29, 30, 31, 
                    32}]}, {}}], {}}, {}, {}, {{{}, {}, {}, {}}, {}}}}, 
             ImagePadding -> 0.2, PlotRange -> {{-3.1, 3.2}, {-3.5, 2.1}}, 
             PlotRangePadding -> Automatic, PlotRangeClipping -> True, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]], Axes -> False, AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Input type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TemplateBox[{"\"NumericalVector\"", 
                    StyleBox[
                    TemplateBox[{"\" (\"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "41"}, 
                    "RowWithSeparators"], "\")\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Output dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{{{{}, {}}, {}, {{}, {}, {
                 GrayLevel[0.7], 
                 AbsoluteThickness[1.8], 
                 Opacity[1.], 
                 LineBox[CompressedData["
1:eJwB8QEO/iFib1JlAgAAAB4AAAACAAAAAAAAAAAAAAAAAAAAAAAAAA3l5opg
ldw/ifaD+DItuD+MkCEodiHjP9qvjCs8v9E/bLbqGG2J5D+WRNoAzOrePxWI
hjT6cuM/qFFV1TM75j8YmI/Y7IHfP/eKfiNPOe0/quVYmD5o1D+ADmRmEGnx
P3eNjU0+TbI/IY3cLB+l8z/z/SDb3KDLv5a/pk3oyvQ/P80MS7g64L+H2H4K
a8b0P9+nsKVohOq/rTamnQZ68z/qrFzHBdfxv6YHIajkDPE/bw9qE5vX9b+Z
SUCP/i3rP/uMEvTgV/m/kzjs/r2F4T/bUNnDc5T7v9G7+cvEhMs/wYIqip+q
/L9jvEi/XoXHvxhoDlvsO/y/eOnDDXz84r8s6yb5EW/6v2qTREHJFe+/UEHO
hnD69r/GEyuZBq31v4JWinxOcPK/c9vQT8is+r8XVSwtro/ov0knBpVW9/6/
yZ09iVcE1b9l2NyAUeAAwDbV0T76Ar4/Y701SKBwAcCmV9X1r7fjP9Pdwu5B
LgHAhEmFnNot8T/aVnzNXBkAwIeJGWTe4Pc/Fl/LTVCK/L9n/YLkNTv+P27f
ThBa+/a/DjFFsd98AUAQoc+DuIDwv00y1JUAQgNAdLxOLvHB4L8FJ/Yfkw0E
QHdYowipHsa8z+n67g==
                  "]]}}, {}, {{{}, {}, {}, {}}, {}}}, {{{}, {}}, {}, {{}, 
                GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQvSOde+X6LwX2L+JEV934or//a9ba9rVPHto/qNs+
h/vZZfumRXKlmjWP7f94fAgTnPDcnk/kyM/O5Bf27XmKKav2f7HfXXOp8OzR
U/ZfddfwhpR8tH/Mf1NimfrD/bmrPms6/Ptsv6/iJO/vs5/3+3H82Z7G+Nqe
6/yMbVMP/dhfKsm+/u3U5/bzr9z7quHMeMBGKvy71POz+5PZdsQbTf23/7d6
VqJF6pf9/teV3u88/Hn/ux/vv2b//bTftGfJ25NKr/eXHb7jHVj0Y39nSUKD
+sIl9od7wyt357EeyI75vbEl+Jl9xCWXx0L8f/a7XHD6XCLA4HD6j8KD5/N+
7l/dca7ELo3ZwUXo+W6J9/f2j3T/AwAmeB/L
                 "], {{}, {
                   GrayLevel[0.5], 
                   PointSize[0.12], 
                   AbsoluteThickness[1.6], 
                   
                   PointBox[{17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
                    29, 30, 31, 
                    32}]}, {}}], {}}, {}, {}, {{{}, {}, {}, {}}, {}}}}, 
             ImagePadding -> 0.2, PlotRange -> {{-3.1, 3.2}, {-3.5, 2.1}}, 
             PlotRangePadding -> Automatic, PlotRangeClipping -> True, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]], Axes -> False, AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Input type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TemplateBox[{"\"NumericalVector\"", 
                    StyleBox[
                    TemplateBox[{"\" (\"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "41"}, 
                    "RowWithSeparators"], "\")\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Output dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"PrincipalComponentsAnalysis\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox[
                 "\"Number of training examples: \"", 
                  "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                 TagBox["36", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  DimensionReducerFunction[<|
   "ExampleNumber" -> 36, "Imputer" -> 
    MachineLearning`MLProcessor[
     "ImputeMissing", <|
      "Invertibility" -> "Perfect", "Missing" -> "Imputed", 
       "StructurePreserving" -> True, 
       "Input" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>, 
       "Fill" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACBmuVjFfrTP7kehetRuNY/vsqhRbbz2T9w
idRSBOncP/FRu67BN98/Vz3CpbIK4D9ClByd4AjgP2V1SWAkUt8/sYlq1V9N
3j/a9NyRE2LdP8M0NUXPj9w/3n+z9rOn2z/KZ9ulXEPaPwnFQwV0TNg/mQtJ
UyrO1j+a0d5CkxPWP4cEeWMultY/4Wi0Qn4j2D/f+YH6+MDaPwMZJ6sPEd8/
LYMI/JKr4T8eDy67653iP15EjHU1quE/ycaW+Lbz4D+MS6SWIkjhP/nix+d3
VuI/mih+23Ur4z+QOLO/KBDjPxLBOLh0TOE/V+3pTBZG3D8Xx26MiiXVPxDw
zauJZ80/EORkk5oBxT8FGSo7TF2+P3jI48uAArk/urYZ4xKptT8AJY0zwiq0
PzmNiy4gUrM/dwkSjCHEsj/OFz8+v7OyP7XpuSMnxLI/8AykoQ==
        "], "Method" -> "Naive", "VectorLength" -> 41, 
       "Output" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>,
        "Type" -> "NumericalVector"|>], "RandomImputer" -> 
    MachineLearning`MLProcessor[
     "ImputeMissing", <|
      "Invertibility" -> "Perfect", "Missing" -> "Imputed", 
       "StructurePreserving" -> True, 
       "Input" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>, 
       "Mean" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACBmuVjFfrTP7kehetRuNY/vsqhRbbz2T9w
idRSBOncP/FRu67BN98/Vz3CpbIK4D9ClByd4AjgP2V1SWAkUt8/sYlq1V9N
3j/a9NyRE2LdP8M0NUXPj9w/3n+z9rOn2z/KZ9ulXEPaPwnFQwV0TNg/mQtJ
UyrO1j+a0d5CkxPWP4cEeWMultY/4Wi0Qn4j2D/f+YH6+MDaPwMZJ6sPEd8/
LYMI/JKr4T8eDy67653iP15EjHU1quE/ycaW+Lbz4D+MS6SWIkjhP/nix+d3
VuI/mih+23Ur4z+QOLO/KBDjPxLBOLh0TOE/V+3pTBZG3D8Xx26MiiXVPxDw
zauJZ80/EORkk5oBxT8FGSo7TF2+P3jI48uAArk/urYZ4xKptT8AJY0zwiq0
PzmNiy4gUrM/dwkSjCHEsj/OFz8+v7OyP7XpuSMnxLI/8AykoQ==
        "], "StandardDeviation" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAADUNT01aT3FP/HgoxSlQMU/7pfDhaelxT8i
3pxAJEnGPzoeE2BnZMY/vnfXAA/Hxj+ZOBdRyXvHPyikeiduZ8g/u+K/528M
yT9VRYEgeM3JP9Z3MHrotMk/Iw0ezYIFyj+hesbRIbLJP+N9rx4ndsk/wDqf
WR+qyT97mkeEGxzKPwGp/gIXE8s/X3dzgmFjzD+vgPmivEPOPw1T0+0UeNE/
B1IjovsY1D8fwJkmtWnUP8f573jFktE/KbvhOz7lzz8XWHfqRzXQPzqAiQTw
RdE/xgODLMIS0j+YKSmUxPPRP9SMdURRVdA/QhzfQTdXyz/xJWuPIETGP+Q1
Ybz3DsM/puylIgMcwj/tozbXV8DBP1e6eelebcI/Xedl3e1Xwj99NCdt4mTC
P/LMPMtZgMI/Wtb93Q1iwj9YMYvu/47CP26yTMrXlMI/uByiBg==
        "], "Method" -> "NaiveSampler", "VectorLength" -> 41, 
       "Output" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>,
        "Type" -> "NumericalVector"|>], "Preprocessor" -> 
    MachineLearning`MLProcessor[
     "ToMLDataset", <|
      "Input" -> <|"f1" -> <|"Type" -> "NumericalVector", "Length" -> 41|>|>, 
       "Output" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>,
        "Preprocessor" -> 
       MachineLearning`MLProcessor["Sequence", <|"Processors" -> {
            MachineLearning`MLProcessor["List"], 
            MachineLearning`MLProcessor[
            "WrapMLDataset", <|
             "FeatureTypes" -> {"NumericalVector"}, "FeatureKeys" -> {"f1"}, 
              "FeatureWeights" -> Automatic, "ExampleWeights" -> Automatic, 
              "RawExample" -> Missing["KeyAbsent", "RawExample"], 
              "StructurePreserving" -> False|>]}|>], "ScalarFeature" -> True, 
       "Invertibility" -> "Perfect", "StructurePreserving" -> False, 
       "Missing" -> "Allowed"|>], "Processor" -> 
    MachineLearning`MLProcessor["Identity"], 
    "Model" -> <|"Matrix" -> CompressedData["
1:eJwBoQJe/SFib1JlAgAAACkAAAACAAAA73ZHRWXTxj8sUKikqOeoP5m4g+q/
A8c/TLYS5OC4gj+nYjBvH+vGP6oRTA6K5pO/beIpLK69xj+jOJHm+kmgv6cb
djKNiMY/BCLG0i5hkr+0l4PVIm7GP0yaI+zHNJk/jXBTqUH3xT/rCdt1VBGy
PwySesejRMU/wBBRPAGPvT/5GuT9dcDEP8vSOngSDMI/EAqqgmNrxD9Wf1TI
ES3EP9mMp/YfdMQ//FFW6w5ixD+rzBgyFbnEP2T3rPUUz8M/ZrmtAyYKxT/K
pEWy/HLCP73s4WMCUMU/HLUnYilQwD9INjQyPGDFP3BEZ4qc8Lo/AhRsF/1d
xT9bGdusv06yP6/TQDMOF8U/Ghy6u4Kamj+CJQZLWoXEP2iOHhU+vpy/6RvF
TM9xwz9f1CLTFM63vzjMs1GUScE/K700FmAFxb9xK8RDTba+P5J3HI9RjMq/
LOzv0lmwvT/gLMA4i9zNv4GT/7RE1r8/BwmOJJ6tz7/qgCH7GBbAP4ZBBbci
nNC/X0rLMMfKvT99HY053FbRv0Nu5d8j2Ls/beVO9UHA0b+RsxUPYaC6P5w8
W52D+tG/+hblkNWzuj8ykD6edcPRvxtAWPxl6bw/0bYBJZjB0L+eB8hizrrA
P9ulukKV0cy/REmF6M2ewz/E48AD+HbEvwusY0XqDMY/TDq7bMP0r79OGLNb
ApDGP2EOwcNhw5M/LSBdke8xxj+vjWx4fA+zP7/CHaA7wMU/wEow4VF8uj8K
aOtTbX7FP8I25yUpAb4/7EwgeXlYxT/dWhM98de/P7QZdPKiScU/D0cWghs/
wD+g3n0KGULFPylvySwiWMA/puCREJc4xT9T4L44sXvAPxaryvK4McU/VOzT
8+iQwD+9jUf6
       "], "Processor" -> 
      MachineLearning`MLProcessor[
       "Sequence", <|
        "Input" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>,
          "Output" -> <|
          "f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>, 
         "Processors" -> {
           MachineLearning`MLProcessor[
           "Standardize", <|
            "Invertibility" -> "Perfect", "Missing" -> "Allowed", 
             "StructurePreserving" -> True, 
             "Input" -> <|
              "f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>, 
             "Mean" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACBmuVjFfrTP7kehetRuNY/vsqhRbbz2T9w
idRSBOncP/FRu67BN98/Vz3CpbIK4D9ClByd4AjgP2V1SWAkUt8/sYlq1V9N
3j/a9NyRE2LdP8M0NUXPj9w/3n+z9rOn2z/KZ9ulXEPaPwnFQwV0TNg/mQtJ
UyrO1j+a0d5CkxPWP4cEeWMultY/4Wi0Qn4j2D/f+YH6+MDaPwMZJ6sPEd8/
LYMI/JKr4T8eDy67653iP15EjHU1quE/ycaW+Lbz4D+MS6SWIkjhP/nix+d3
VuI/mih+23Ur4z+QOLO/KBDjPxLBOLh0TOE/V+3pTBZG3D8Xx26MiiXVPxDw
zauJZ80/EORkk5oBxT8FGSo7TF2+P3jI48uAArk/urYZ4xKptT8AJY0zwiq0
PzmNiy4gUrM/dwkSjCHEsj/OFz8+v7OyP7XpuSMnxLI/8AykoQ==
              "], "StandardDeviation" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAADUNT01aT3FP/HgoxSlQMU/7pfDhaelxT8i
3pxAJEnGPzoeE2BnZMY/vnfXAA/Hxj+ZOBdRyXvHPyikeiduZ8g/u+K/528M
yT9VRYEgeM3JP9Z3MHrotMk/Iw0ezYIFyj+hesbRIbLJP+N9rx4ndsk/wDqf
WR+qyT97mkeEGxzKPwGp/gIXE8s/X3dzgmFjzD+vgPmivEPOPw1T0+0UeNE/
B1IjovsY1D8fwJkmtWnUP8f573jFktE/KbvhOz7lzz8XWHfqRzXQPzqAiQTw
RdE/xgODLMIS0j+YKSmUxPPRP9SMdURRVdA/QhzfQTdXyz/xJWuPIETGP+Q1
Ybz3DsM/puylIgMcwj/tozbXV8DBP1e6eelebcI/Xedl3e1Xwj99NCdt4mTC
P/LMPMtZgMI/Wtb93Q1iwj9YMYvu/47CP26yTMrXlMI/uByiBg==
              "], 
             "Output" -> <|
              "f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>|>], 
           MachineLearning`MLProcessor[
           "FirstValues", <|
            "Info" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>, "Key" -> 
             "f1", "Invertibility" -> "Perfect", "StructurePreserving" -> 
             False, "Missing" -> "Allowed"|>]}, "Invertibility" -> "Perfect", 
         "StructurePreserving" -> False, "Missing" -> "Allowed"|>], 
      "FinalDimension" -> 2, "Padder" -> 
      MachineLearning`MLProcessor["Identity"], "Method" -> 
      "PrincipalComponentsAnalysis"|>, "PerformanceGoal" -> Automatic, 
    "Invertibility" -> "Approximate", 
    "Log" -> <|
     "TrainingTime" -> 0.019546, "MaxTrainingMemory" -> 129696, "DataMemory" -> 
      37200, "FunctionMemory" -> 24824, "LanguageVersion" -> {13.2, 0}, 
      "Date" -> DateObject[{2023, 7, 18, 16, 50, 31.881938`8.256119693589426},
         "Instant", "Gregorian", -4.], "ProcessorCount" -> 4, "ProcessorType" -> 
      "x86-64", "OperatingSystem" -> "MacOSX", "SystemWordLength" -> 64, 
      "Evaluations" -> {}|>|>],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.898688555156459*^9, 3.898702082910101*^9, 
  3.8987022319011106`*^9},
 CellLabel->
  "Out[399]=",ExpressionUUID->"75b2bfb5-d2e2-4c7b-a0e8-05e93b255ba3"]
}, Open  ]],

Cell["\<\
Define a convenience function for cross validating different model types:\
\>", "Text",
 CellChangeTimes->{{3.898701911683771*^9, 
  3.898701928427698*^9}},ExpressionUUID->"765c7fce-fb3d-489a-8b1c-\
0045e6e965ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"crossValidate", "[", 
   RowBox[{"data_", ",", "modelType_String"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ResourceFunction", "[", "\"\<CrossValidateModel\>\"", "]"}], "[", 
   "\[IndentingNewLine]", 
   RowBox[{"data", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Predict", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Method", "->", "modelType"}]}], "]"}], "&"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<ValidationFunction\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<MeanDeviation\>\"", ",", "\"\<RSquared\>\""}], "}"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.898688247132247*^9, 3.898688297225319*^9}, 
   3.8986953758368397`*^9},
 CellLabel->
  "In[401]:=",ExpressionUUID->"90cfb06f-3599-429c-9ce9-08149cfca993"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Mean", " ", "absolute", " ", "error", " ", "and", " ", 
     RowBox[{"R", "^", "2"}]}], ",", " ", 
    RowBox[{
     RowBox[{"over", " ", "5"}], "-", 
     RowBox[{"fold", " ", "cross", " ", "validation"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cvLinearRegressionSummary", "=", 
     RowBox[{"crossValidate", "[", 
      RowBox[{"transformedData", ",", "\"\<LinearRegression\>\""}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{"MeanAround", "/@", 
    RowBox[{"Transpose", "@", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8986876933088207`*^9, 3.8986877435404177`*^9}, {
  3.898687836220169*^9, 3.898687959876041*^9}, {3.898688113964772*^9, 
  3.898688121555772*^9}, {3.898688305788598*^9, 3.898688326723329*^9}, {
  3.89868841870205*^9, 3.898688420421874*^9}},
 CellLabel->
  "In[402]:=",ExpressionUUID->"3322ca10-b9dd-4243-84b1-d731cb001f94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"1.08", "0.11"},
     "Around"],
    Around[1.0777027988580075`, 0.10742992840757612`]], ",", 
   InterpretationBox[
    TemplateBox[{"0.67", "0.11"},
     "Around"],
    Around[0.6706218670009115, 0.11199467591124013`]]}], "}"}]], "Output",
 CellChangeTimes->{{3.8986879695756197`*^9, 3.898688006790783*^9}, 
   3.898688142465499*^9, {3.89868841694981*^9, 3.898688426407024*^9}, 
   3.898702088671728*^9, 3.89870223761812*^9},
 CellLabel->
  "Out[403]=",ExpressionUUID->"6dabefe0-ceff-472b-b6bb-854f50d03752"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvNearestNeighborSummary", "=", 
   RowBox[{"crossValidate", "[", 
    RowBox[{"transformedData", ",", "\"\<NearestNeighbors\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MeanAround", "/@", 
  RowBox[{"Transpose", "@", 
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.898688079595908*^9, 3.898688095659484*^9}, {
  3.898688131483705*^9, 3.898688134138982*^9}, {3.898688351541561*^9, 
  3.898688356602837*^9}, {3.898688423549199*^9, 3.898688425277268*^9}},
 CellLabel->
  "In[404]:=",ExpressionUUID->"145a2da5-fe48-4611-862f-325957bb5e56"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"1.39", "0.16"},
     "Around"],
    Around[1.3942928563515982`, 0.1569457173272032]], ",", 
   InterpretationBox[
    TemplateBox[{"0.50", "0.07"},
     "Around"],
    Around[0.50410502834075, 0.07406290859495902]]}], "}"}]], "Output",
 CellChangeTimes->{3.898688144851747*^9, 3.898688429536255*^9, 
  3.898702091485228*^9, 3.898702240390067*^9},
 CellLabel->
  "Out[405]=",ExpressionUUID->"32be7579-8128-453a-8681-de7d10cfb411"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvRFSummary", "=", 
   RowBox[{"crossValidate", "[", 
    RowBox[{"transformedData", ",", "\"\<RandomForest\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MeanAround", "/@", 
  RowBox[{"Transpose", "@", 
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.898688367018794*^9, 3.8986883722825527`*^9}, {
  3.898688431199299*^9, 3.898688432982481*^9}},
 CellLabel->
  "In[406]:=",ExpressionUUID->"6ab070d3-20f4-4fc5-a483-2dc4e1aaded5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"1.37", "0.16"},
     "Around"],
    Around[1.3724252487370214`, 0.16087998283512095`]], ",", 
   InterpretationBox[
    TemplateBox[{"0.56", "0.05"},
     "Around"],
    Around[0.5634024250463805, 0.05106317295289999]]}], "}"}]], "Output",
 CellChangeTimes->{3.898688405831884*^9, 3.8986884359961443`*^9, 
  3.898702093661461*^9, 3.898702242410735*^9},
 CellLabel->
  "Out[407]=",ExpressionUUID->"0940c132-1a45-4937-b94c-de6fd1710f2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cvGBTSummary", "=", 
   RowBox[{"crossValidate", "[", 
    RowBox[{"transformedData", ",", "\"\<GradientBoostedTrees\>\""}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"MeanAround", "/@", 
  RowBox[{"Transpose", "@", 
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.898688451414836*^9, 3.898688469057435*^9}},
 CellLabel->
  "In[408]:=",ExpressionUUID->"b58840e3-f9d5-4703-91b5-8851fdd211e3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"1.29", "0.31"},
     "Around"],
    Around[1.2922650913218412`, 0.3091195212622288]], ",", 
   InterpretationBox[
    TemplateBox[{"0.53", "0.16"},
     "Around"],
    Around[0.5284075045491508, 0.15753446231449791`]]}], "}"}]], "Output",
 CellChangeTimes->{{3.898688461349966*^9, 3.898688475255445*^9}, 
   3.898702099414659*^9, 3.8987022480964746`*^9},
 CellLabel->
  "Out[409]=",ExpressionUUID->"f1884661-453d-4031-86ea-a609cdab4887"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Conclusion: ",
  FontWeight->"Bold"],
 " Reducing the dimensionality to 2 dimensions (by PCA) allows for a linear \
regression model to predict pH with a mean error of 1 pH unit, from the \
spectroscopic observation, as established by 5-fold cross validation (based \
on training the model on ~28 examples and evaluating on ~7 test cases); other \
models are worse."
}], "Text",
 CellChangeTimes->{{3.89868848873427*^9, 3.898688646654128*^9}, {
  3.898694614959653*^9, 3.898694661902998*^9}, {3.898702261984062*^9, 
  3.898702268199959*^9}},ExpressionUUID->"d7a9b6a2-af6d-4743-9ba0-\
77b4a6d7ad96"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
How good can a nearest-neighbor model perform with this dataset\
\>", "Section",
 CellChangeTimes->{{3.898702574902722*^9, 
  3.8987026015339127`*^9}},ExpressionUUID->"b8e6ecb3-874b-42ff-a200-\
970e8a25147b"],

Cell[TextData[{
 StyleBox["For reference",
  FontWeight->"Bold"],
 ":  If the error was bounded by the distance to the nearest example...how \
much would our pH error be? (In other words, if we had a perfect classifier \
that had to put things into the nearest example, how close would it be? \
Assess this by sampling 5 times"
}], "Text",
 CellChangeTimes->{{3.898688713573777*^9, 3.8986887367260942`*^9}, {
  3.8986888132304087`*^9, 3.898688824254294*^9}, {3.898694667295005*^9, 
  3.898694667630776*^9}, {3.898702953250988*^9, 
  3.898703013290135*^9}},ExpressionUUID->"f91d9ff0-26ce-45dc-a0f8-\
cdcf6645d84c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sample", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"train", ",", "test"}], "}"}], "=", 
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<TrainTestSplit\>\"", "]"}], "[",
         "measuredpH", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pred", "=", 
       RowBox[{"Flatten", "[", " ", 
        RowBox[{"First", "/@", 
         RowBox[{
          RowBox[{"Nearest", "[", "train", "]"}], "/@", "test"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Mean", "@", 
         RowBox[{"Abs", "[", 
          RowBox[{"test", "-", "pred"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Correlation", "[", 
          RowBox[{"test", ",", "pred"}], "]"}], "^", "2"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MeanAround", "/@", 
  RowBox[{"Transpose", "[", "sample", "]"}]}]}], "Input",
 CellChangeTimes->{{3.898702345529038*^9, 3.898702351304068*^9}, {
  3.898702604510951*^9, 3.898702727836894*^9}, {3.898702772229437*^9, 
  3.8987028941717463`*^9}, {3.898702993283979*^9, 3.898703016251086*^9}},
 CellLabel->
  "In[462]:=",ExpressionUUID->"40f2a1e6-7c43-4bc2-be1e-506bccec506d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"0.148", "0.019"},
     "Around"],
    Around[0.1482857142857144, 0.019242809417694514`]], ",", 
   InterpretationBox[
    TemplateBox[{"0.9940", "0.0017"},
     "Around"],
    Around[0.9939578950884217, 0.0016825705572403335`]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.898702351704084*^9, {3.898702643721541*^9, 3.898702728265355*^9}, {
   3.898702772837981*^9, 3.898702785725173*^9}, {3.898702847297388*^9, 
   3.898702894863525*^9}, {3.898702993880221*^9, 3.898703016827828*^9}},
 CellLabel->
  "Out[463]=",ExpressionUUID->"f175dd63-514b-4abe-80b7-ee3c3e7a473b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approach 2:  Optimal Transport Classifier", "Section",
 CellChangeTimes->{{3.898688658894486*^9, 
  3.898688664398024*^9}},ExpressionUUID->"3cd55a60-d3fe-4071-a2d9-\
d4a5b429d367"],

Cell[TextData[{
 StyleBox["Concept: ",
  FontWeight->"Bold"],
 " Try to find the most similar spectrum (by Earth Mover Distance, aka W1 \
Wasserstein metric) and assign that pH to the unknown spectrum.\n\nFurther \
reading:\nSee:  https://en.wikipedia.org/wiki/Earth_mover%27s_distance\nSee: ",
 StyleBox["JCP 2021",
  FontSlant->"Italic"],
 " https://doi.org/10.1063/5.0069681\nSee: ",
 StyleBox["JCP",
  FontSlant->"Italic"],
 " 2022 https://doi.org/10.1063/5.0087385 "
}], "Text",
 CellChangeTimes->{{3.898692747236281*^9, 3.898692783700234*^9}, {
   3.898692949011818*^9, 3.898692951548645*^9}, {3.898702380951612*^9, 
   3.898702418383383*^9}, 
   3.8987035325340767`*^9},ExpressionUUID->"c9196d79-53ca-43a6-9487-\
e44be5930ced"],

Cell[CellGroupData[{

Cell["Data processing", "Subsection",
 CellChangeTimes->{{3.898692964348463*^9, 
  3.89869296812438*^9}},ExpressionUUID->"f2b9c36f-52c2-4632-9eb9-\
eac4914d403b"],

Cell["\<\
We need the spectra to be positive and sum to 1; shift by the smallest value \
(using a scalar addition) and then normalize by the Total value of the \
vector: \
\>", "Text",
 CellChangeTimes->{{3.898692969419979*^9, 3.898692977132577*^9}, {
  3.898693442405561*^9, 
  3.898693464517045*^9}},ExpressionUUID->"4a5df680-31de-4a6a-8375-\
c5ae0415a814"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"normalizeSpectrum", "[", 
    RowBox[{"l_", "?", "VectorQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Normalize", "[", 
      RowBox[{"#", ",", "Total"}], "]"}], "&"}], "@", 
    RowBox[{"(", 
     RowBox[{"l", "-", 
      RowBox[{"Min", "[", "l", "]"}]}], ")"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalizedData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"normalizeSpectrum", "[", 
        RowBox[{"entry", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
       RowBox[{"entry", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"entry", ",", " ", "data"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.898692980349264*^9, 3.898693103077279*^9}, {
   3.898693184576879*^9, 3.898693187221705*^9}, {3.898693417462105*^9, 
   3.8986934196619864`*^9}, 3.8986934681926622`*^9, 3.898702123210466*^9},
 CellLabel->
  "In[412]:=",ExpressionUUID->"0c04f9c7-5577-45f5-94c0-e7b8208e179c"],

Cell["\<\
This seems to improve the wandering baseline issue noted above:\
\>", "Text",
 CellChangeTimes->{{3.8986934773171587`*^9, 3.898693487669114*^9}, 
   3.898695775564712*^9, {3.898702115657094*^9, 3.898702117457582*^9}, {
   3.898703575981599*^9, 
   3.898703576149618*^9}},ExpressionUUID->"728ae7d6-f9cd-407a-8b38-\
b39c3acd0e22"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "2"}], "]"}], "]"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"DataRange", "->", 
    RowBox[{"MinMax", "[", "wavelengths", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<Wavelength (nm)\>\"", ",", "\"\<Abs\>\""}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.89869310860848*^9, 3.898693164533391*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"6adb5dd1-563a-4d6f-8274-e0a5bea8f60b"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh2ep75o898zwx7MbyhzEC4/d3llAJSvUO7g
GOljvJB7JoR/oNxhGqNXk5HhbAg/ocKB5XDysqqH8yB8hkqHnEmLTlQnLITw
F1Q6rDcrf9U9fzGE71DlsKTCl+uC3DII/0GVg99at+adf6D8hmqH1c5a197W
rYDaX+Mg88vkGIPFSqj9NQ5PL+4+J2+yCmp/rcMzjcaHe62gfIY6B9YzfIWf
I6D8BXUOZ+6vmfv7A5TvUO8g9WPK4fU5q6H21zu86n+ZvP0ilO/Q4FAx97j/
7hoof0KDw0+dVXz2ilD9DxocduosFdn1azmEb9DooJel21ZWCXN/o0PilYoX
++9D/Xuh0WFCruwpppVzoP5pctDg0BGpWDYBwi9ocqji+2V7vq4B6r8mB61k
04eTEwogfIFmhxOr5vTEPUmB+rfZofrusc3vvkdC+BuaHZQdq5cu2OcL9X+L
A0Me+93cXDcIP6DFgVegVvNiphM0PFoczttP2nhttjmE/6HFQWGiRs+tHaZQ
/7c61G2edGnRMROo/1sdJGQ1svn6NKD+b3UoZ9Fcu+yxEtT/bQ4P+EHmG0H9
3+ZQ9+73tUt1mlD/tzncufpHIvuKMtT/7Q4MyKCg3cEwUZjlapuBPQDiRswQ

         "]]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh2sO1+VbbSZbQ/mN5Q5eGlOUAiqnAnhK5Q7
6HZd2/j8AlT+QLlDypLY4AML50L4CRUOYjkHFkUVzIHwGSodfqmE5aXyLILw
F1Q6sGtcXSv6bjGE71DlwP7mctg0zaUQ/oMqB9nzKYK+Tcug9lc7FOZEbXa+
shxqf41Di2n49685UP6BGodnac9+fdNZCbW/1kHaY769YyyUz1DnkLrmn0LB
rxVQ++scDm4x64qPg8o71DvYGKQZfvgHlX9Q77BQsTO5uwUm3+Awce3SV5s3
Q/kTGhxCSmT+i7+D2v+gweHntbifz9uh7jVodPBexrCI3xzqn4ZGh7wFezfu
mbEQwr/Q6MCXtPjdpS+zoP5pcuAT+VywyXgihF/Q5PDDufe+65RqqP+aHG6y
1DYuPloF4Qs0O7zdtPZctE8x1L/NDu/OWqY1yxdC+BuaHaR+py18oZMH9X+L
w9VC9bZqjWwIP6DF4eO8TeLPD/hCw6PFIVHI2dd8fSaE/6HFQb1oW9z6B2lQ
/7c6MCCDCa0OK/1Pvb+aXQL1f6uDyvp1GlJPU6H+b3MIWL6/wqQbym9oc1Ce
ojTxk2AG1P9tDged51Q/5giD+r/dIetB5qMvgjlQ/7fD3QsAq8XOGw==
         "]]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 72], 0.013888888888888888`]], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh2CeZMZr5rMsgfzG8ocngo9F9jOOhvCVyh3
mFcXGvBhwlwI/0C5g9keX5kvHQsg/IQKB7swV47bBoshfIZKh21/OX8vXbkU
wl9Q6aDj9ebOXc4VEL5DlQPn1Hllvp6rIPwHVQ6lCX+k0nxXQ+2vdvjze8Ep
DpE1UPtrHEw3+p44ZQLlH6hxeHoqVOxVH1R9Qq2DqrxSxKc+qHkMdQ5FN0Nd
Xd1XQu2vc0iPqn5t5Ayzv97hoeROH+Wpy6H21zuwh9zf/iYRyndocKiOZ7p9
+NYyCH9Cg8Of8opMq7dQ/zxocKi9wm7XqbIEwjdodEh77dtiLgb1f0Ojw1vn
zok5c6Hhc6HRoUa88MG35OlQ/zQ5lE6eJJ1wqhPCL2hy4OP49ZXVuhzqvyYH
Z9etk+Yyp0H4As0Olo0s8i/zY6H+bXZIffzn4KwTYRD+hmaHzASlU4csQqD+
b3FY4HhkpU9eEIQf0OKgynB9bYJaIDQ8WhyOfHy5vfa7M4T/ocUh82nDNy9T
P6j/Wx24gkyv3Od0h/q/1SEvadm/oqXWUP+3OtROnDdb+qkD1P9tDnzno+6w
V7lA/d/mwCzb4d6+ygbq/zaHi9varUsrVKD+b3cIXind5xL4wQ7i/3YHBigA
ADWQxYo=
         "]]}}}, {{}, {{}, {}}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {341.6666666666674, 0}, 
     DisplayFunction :> Identity, Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{
        FormBox[
         TagBox["\"Abs\"", HoldForm], TraditionalForm], None}, {
        FormBox[
         TagBox["\"Wavelength (nm)\"", HoldForm], TraditionalForm], None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
       "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
       "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{341.6666666666674, 750.}, {0, 0.05509027190314201}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.08090169943749476]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{"4.75`", "4.72`", "4.87`"}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "72"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "72"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "72"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.898693114522943*^9, 3.89869311824621*^9}, {
   3.89869315747329*^9, 3.898693165062871*^9}, 3.898693422173324*^9, 
   3.898702099579183*^9, 3.89870224828962*^9},
 CellLabel->
  "Out[414]=",ExpressionUUID->"eec02082-0bf9-42d8-90e5-580f23235503"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model construction and analysis", "Subsection",
 CellChangeTimes->{{3.898694404254608*^9, 3.898694405062964*^9}, {
  3.898701510662994*^9, 
  3.898701515702944*^9}},ExpressionUUID->"97e098d5-df1b-4cd7-823a-\
b0780207db30"],

Cell[BoxData[
 RowBox[{"<<", "\"\<src/emd.wl\>\"", " ", 
  RowBox[{"(*", 
   RowBox[{
   "import", " ", "the", " ", "earth", " ", "mover", " ", "distance", " ", 
    "code"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8986944209200487`*^9, 3.898694424551083*^9}, {
  3.898695781280542*^9, 3.898695786549046*^9}, {3.898701369923987*^9, 
  3.898701370483572*^9}},
 CellLabel->
  "In[415]:=",ExpressionUUID->"64a6599b-44de-44a7-be44-46e1146eee21"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "define", " ", "a", " ", "function", " ", "for", " ", "model", " ", 
     "validation", " ", "during", " ", "CV"}], ",", " ", 
    RowBox[{
     RowBox[{
     "as", " ", "EMD", " ", "is", " ", "not", " ", "a", " ", "built"}], "-", 
     RowBox[{"in", " ", "classifier"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"validation", "[", 
     RowBox[{"model_NearestFunction", ",", "validationData_List"}], "]"}], ":=", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"obs", "=", 
         RowBox[{"validationData", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"predicted", " ", "=", " ", 
         RowBox[{
          RowBox[{"model", "/@", 
           RowBox[{"validationData", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "//", "Flatten"}]}]}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Mean", "@", 
         RowBox[{"Abs", "[", 
          RowBox[{"obs", "-", "predicted"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Correlation", "[", 
          RowBox[{"obs", ",", "predicted"}], "]"}], "^", "2"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"perform", " ", "5"}], "-", 
     RowBox[{
     "fold", " ", "cross", " ", "validation", " ", "of", " ", "the", " ", 
      "EMD", " ", "model"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cvEMDSummary", "=", 
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<CrossValidateModel\>\"", "]"}], 
      "[", "\[IndentingNewLine]", 
      RowBox[{"normalizedData", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Nearest", "[", 
         RowBox[{"#", ",", 
          RowBox[{"DistanceFunction", "->", "emd"}]}], "]"}], "&"}], ",", " ", 
       RowBox[{"(*", 
        RowBox[{"model", " ", "definition"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<ValidationFunction\>\"", "->", "validation"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"collect", " ", "summary", " ", "statistics"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MeanAround", "/@", 
    RowBox[{"Transpose", "@", 
     RowBox[{"%", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], 
      "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.898695363057292*^9, 3.898695397728511*^9}, {
  3.898695514615293*^9, 3.898695547751058*^9}, {3.898695601958559*^9, 
  3.898695633854141*^9}, {3.8986956882704353`*^9, 3.898695706734109*^9}, {
  3.898695815199388*^9, 3.898695815372982*^9}, {3.898695858556755*^9, 
  3.898695865292941*^9}, {3.898695983075714*^9, 3.8986963746798677`*^9}, {
  3.898696415303406*^9, 3.898696418913911*^9}, {3.898696627543304*^9, 
  3.8986967220609617`*^9}, {3.898701422957809*^9, 3.8987014559703407`*^9}, {
  3.898703144106369*^9, 3.8987031545459557`*^9}, {3.898703597750123*^9, 
  3.898703604317762*^9}},ExpressionUUID->"f28e6b96-6714-4946-8eee-\
87ffefc1f2ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"0.41", "0.08"},
     "Around"],
    Around[0.41125000000000006`, 0.08231104675781586]], ",", 
   InterpretationBox[
    TemplateBox[{"0.938", "0.026"},
     "Around"],
    Around[0.937565986903093, 0.026199483085075498`]]}], "}"}]], "Output",
 CellChangeTimes->{{3.898696269892115*^9, 3.8986963486237917`*^9}, 
   3.898696431626842*^9, {3.8986966939811707`*^9, 3.8986967343375063`*^9}, 
   3.898702143704657*^9, 3.898702218046342*^9, 3.898702259425797*^9},
 CellLabel->
  "Out[418]=",ExpressionUUID->"5cdb4814-e1c1-4596-86e3-19c8781fad58"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Comment:",
  FontWeight->"Bold"],
 "  Observe how the pH error is less than half of what we observed \
previously; still about 3x the theoretical minimum."
}], "Text",
 CellChangeTimes->{{3.898696725843224*^9, 3.898696757595469*^9}, {
  3.8987022876167307`*^9, 3.898702303848242*^9}, {3.898703037265913*^9, 
  3.898703040562002*^9}},ExpressionUUID->"4056c1a5-8e06-488f-8437-\
d2ce553e8b5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Aside: What do the normalized spectra look like over a range of pH values?\
\>", "Subsection",
 CellChangeTimes->{{3.898701797988566*^9, 
  3.898701832396337*^9}},ExpressionUUID->"01a11af8-fded-4574-9373-\
e7f84c52b465"],

Cell["\<\
Make the same plot we generated at the beginning, but now using the \
normalized values.\
\>", "Text",
 CellChangeTimes->{{3.898701833988152*^9, 
  3.898701843588109*^9}},ExpressionUUID->"4b50bf2c-34ad-43bb-88dd-\
a47983e311f9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "10", "]"}], "]"}], ",", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "15", "]"}], "]"}], ",", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "20", "]"}], "]"}], ",", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "25", "]"}], "]"}], ",", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "30", "]"}], "]"}], ",", 
     RowBox[{"normalizedData", "[", 
      RowBox[{"[", "35", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "1", ",", "5", ",", "10", ",", "15", ",", "20", ",", "25", ",", "30", 
         ",", "35"}], "}"}], ",", "2"}], "]"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"DataRange", "->", 
    RowBox[{"MinMax", "[", "wavelengths", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<Wavelength (nm)\>\"", ",", "\"\<Abs\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.898701806925282*^9, 3.89870182339158*^9}},
 CellLabel->
  "In[419]:=",ExpressionUUID->"24c55070-af87-4f2a-87d5-8bc3c85a4832"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh2ep75o898zwx7MbyhzEC4/d3llAJSvUO7g
GOljvJB7JoR/oNxhGqNXk5HhbAg/ocKB5XDysqqH8yB8hkqHnEmLTlQnLITw
F1Q6rDcrf9U9fzGE71DlsKTCl+uC3DII/0GVg99at+adf6D8hmqH1c5a197W
rYDaX+Mg88vkGIPFSqj9NQ5PL+4+J2+yCmp/rcMzjcaHe62gfIY6B9YzfIWf
I6D8BXUOZ+6vmfv7A5TvUO8g9WPK4fU5q6H21zu86n+ZvP0ilO/Q4FAx97j/
7hoof0KDw0+dVXz2ilD9DxocduosFdn1azmEb9DooJel21ZWCXN/o0PilYoX
++9D/Xuh0WFCruwpppVzoP5pctDg0BGpWDYBwi9ocqji+2V7vq4B6r8mB61k
04eTEwogfIFmhxOr5vTEPUmB+rfZofrusc3vvkdC+BuaHZQdq5cu2OcL9X+L
A0Me+93cXDcIP6DFgVegVvNiphM0PFoczttP2nhttjmE/6HFQWGiRs+tHaZQ
/7c61G2edGnRMROo/1sdJGQ1svn6NKD+b3UoZ9Fcu+yxEtT/bQ4P+EHmG0H9
3+ZQ9+73tUt1mlD/tzncufpHIvuKMtT/7Q4MyKCg3cEwUZjlapuBPQDiRswQ

         "]]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh3WySx9wGI73x7MbyhzWB27S+DomwUQvkK5
Q77UayVhucUQ/oFyh0VHnizLMVoG4SdUOKjGH7ljvG0lhM9Q6bD1vpHPh71r
IPwFlQ5dm7c/eXZvPYTvUOXQu6+oyYhrI4T/oMpBgu8gs1gzlN9Q7bBCfeun
lnIoX6HG4ZJg5+ocZSj/QI2Dk8c2HRHBDVD7a1HtY6hzOJUjuNFo9Qqo/XUO
Bzb7LhX9vgRqf73Dk1OODFxNC6H21zvM9RPglqueC5VvcOj4UVN2tmAmhD+h
waHv5LmEpKhpUPUNDuu8th3oq5oM4Rs0OkSLBeq/eTYR6v5GB6bHHZe1dPoh
/AuNDnJdFZcPG7RD/dPk0By6+8kRsToIv6DJwa3B4pZjSBHUf00Oi6ceuVdZ
nQfhCzQ7CFUFJ8juzIb6t9nhe4Xs+8pHmRD+hmaH/a7vzlWpZkH93+LQfafj
82OhNAg/oMXhLHd/2ur1CdDwaHHYUmZts/VOGIT/ocXhEP8O4cfnQ6H+b3XQ
edR0SuCrL9T/rQ731spa5iXaQP0P5Au8a2lb5g71f5vDccejis6srlD/tzkk
2Znrxl4wgPq/zWED/5mi53LmUP+3O5SvviliEKQN9X+7AwMUAACzlcj3
         "]]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0CT+meT+KbZg/mN5Q53D1j1GTxfCaEr1Du
0Lvp4nr9G/Mg/APlDnI+O/ImP1kI4SdUOCwMv1v7JXwJhM9Q6XCyXkPk3eal
EP6CSodDnyplbi9bBuE7VDn4r/VgKU+B8h9UOaR3tDEcugJV31DtsKh+5bkH
H6HmKdQ45PNInFj7fzHU/hoHQ9Efqp9nLYLaX+uw6pXytzP5C6D21zlYtO+z
13o7G2p/nUOu1daOuG9Q/znUO4iql/zMuTUJan+9Q+pDVn71wAlQ+QaHF4q3
H7bY9kH4Exoc9KIkvqSc6oeqb3C4t8Qgb+PmiRC+QaNDsELcRwbfKVD3Nzps
zM0UO7VnOoR/odEh3N75asI8qHsUmhxe5d6/vip0PoRf0OSwVW3rVklJqH8O
NDmsMFERfzAD6n+BZgfuPO22RjNoeCU0O3ydoGwSuwPK39DswOYstnDaeVj4
tzg0LFp+peUJNDwCWhy+cHSoKbXNgIZHi8Prw/y/PKb0QvgfWhwCX0w3sHnR
CPV/q4ObtJ9xr1Yh1P+tDmfeLG3YNDEN6v9Wh0CeyVo3zoRD/d/m8Fpv1+ot
f72g/m9zWJTRtq3wrAfU/20OSj6XHzN1WEL93+7gIjavU+K+IdT/7Q4MUAAA
qwjNrQ==
         "]]}, {
        Hue[0.37820393249936934`, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0ue2yf3xI12R7MbyhzsL5V5tjYMg3CVyh3
yLm7a5FuxGwI/0C5w2X57sgVefMh/IQKB3G351xq9xdC+AyVDjoL5vSFPlgE
4S+odPBvfSF+i2ExhO9Q5bBddmHdWwOo/IMqh4rre2zDvaH6G6odJmW/9WUM
WQC1v8ZhFWv1SyM2qH0Hahw2O671UTCeC7W/1iGwRum19ORZUPvrHAQLy591
ckyH2l/n0KNvsOgn6xSo/fUOa36l7VCcOxFqf72D9YYlosvXTYDKNzg83KNU
EO8BlZ/Q4LB4n0moSQE0fB40OLCYXji97Q80fAwaHbwS/+1f+BVqf0Ojwylp
2TWHlKHuvdDowHq1mjOpG+o/hSaHp22iE091Q8OjoMlh5yaXAl/uZVD/NTks
DzvUUrZoBYQv0Oyw5bDJBKuuVVD/Njts0/TfYHYeyt/Q7BC7t2F1RRxUPUOL
w9sDrFe1iqDmB7Q43JncWDS3Fhp/C1oc5Bhki4WvQf37ocWhviBSdfvEZqj/
Wx2O7lWYpW9dAvV/q4PT8Z0738xNhfq/1aF0e5iK5dlQqP/bHDwVbD0L1rpC
/d/mIKfO5LJ6izHU/20OytZavevWqEL93+4wcY6KwN/0+3YQ/7c7MEABAKP4
xSA=
         "]]}, {
        Hue[0.6142719099991583, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh1kWWtW3NSfYA/mN5Q5bP6numoKy1QIX6Hc
oXzOJ+vVqTMh/APlDqwfChYnTJoD4SdUOGyZUPzEvhHKZ6h0mJunOVNBaRaE
v6DSoc3nvi/j4ekQvkOVw859z3REH0DNf1DlsO/kRbummVOg9lc7XFTT6rx2
czLU/hqHo5VSByduh/IP1DhcEr5qF/IQyk+odTjeqNH51hSqn6HOoaX5WQZH
KpS/oM7hnLKv/dF5UPsc6h3WcB9M+NI2A2p/vUOssNlJ/X1zofINDg8c98UJ
yy+C8Cc0ODDwWWukpS6Dqm9waP59pmgq31oI36DRoS5tpxd7+0ao+xsdLpcH
HyjYB+VfaHTIfPrZeafuGqh/mhxOear2qH1YCuEXNDmUt07j/a27GOq/Jocy
5snSKXxQvkCzw7SWp6GnyqD8hGaHg9axBit+Q923odkhulVWm//hAqj/Wxzk
QtZKf/GBhn9Ai0NukN/2KT6ToOHR4vD5Y80OHpk2CP9Di8PlL8FvJKsrof5v
dbi64v8hgZmZUP+3OtzOOa65f3MU1P+tDh5iORU/vD2h/m9z2GPLe3XWESuo
/9sccn2mKBdd04b6v82B9x7D/fxecaj/2x1cQM4RuGgH8X+7AwMUAADUYciy

         "]]}, {
        Hue[0.8503398874989481, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh34jwbbvradbA/mN5Q5BLXNeW71eRqEr1Du
4JnLr9PdOgvCP1DuEOo5JSreZC6En1DhEPD78ek2t3kQPkOlwzf3ADFtX6j8
gkqH38lLNgRNng3hO1Q5sMoruC/unQnhP6hyYIoT+5z0aDrU/moHH03vmpjp
MPtrHOoeBC0yEoTyD9Q47JdfuEpk9lSo/bUOdnKGFv6SUD5DnUOb9KGtP0un
QO2vc7hjv4L7WDaU71DvsCMxztTnBFT9g3qHDF5lgWOvZ0DlGxzuTxHZ+7ED
6v4JDQ7/N/v8Evu6EKq+weHUpteWT28vg/ANGh1+zbUtDpi8Gur+RgfF3Sbe
v/etgfAvNDpY1BYb3nmxAuqfJoejyna3Qm8shfALmhw2qVYITZaA8g80OUx9
42TO+QXKF2h2yP2ou710P9S+hGYH1pLavsOxUP6GZoflk3SbD11fDPV/i0Nw
dtmmMu35EH5Ai4POSu2LIZOg/l3Q4uCqf9PSx6MLwv/Q4nA8t/fGypl1UP+3
OrBPXOBTzpEP9X+rg0RnpWjx33io/1sdvs043lwt7Af1f5uDTm+xpQmXA9T/
bQ7iLz/zZ2vqQv3f5rCb59D9JZwKUP+3O2wqDXTjsr1uB/F/uwMDFAAAE5XE
XQ==
         "]]}, {
        Hue[0.08640786499873876, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[0.363898, 0.618501, 0.782349], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh38Du99a/1roj2Y31Dm0Ke4hC2mcyqEr1Du
UH/CbM/D/zMh/APlDreN+o9M2joXwk+ocJDk3qq7X3QBhM9Q6VD6TZ/vuSWU
v6DSYVpYcBFr4nwI36HKoVsvt+SqJVT/gyqHUOZbjtqas6H2VzvIK7Js6mqC
2qdQ4/Bx29xSj74ZUPtrHJYszmVXaZ0Otb/W4eu6aC42pWlQ++scjr3Z+SOq
eArU/jqHA6k27VONJ0Ptr3do2cCQpvRjEtT+egdZmdr1wXZQ9Q4NDt714paF
glDzJzQ4LFAsnzG1E+q+Bw0O9qknF3TpLITwDRodtj1jaBRKWAJ1f6PDm3mc
jv0uyyD8C40O/7Kfn/LhgPIVmhyKuI7qtXJD+QVNDt8Pif1XDFkO9V+Tw6fV
Br1M5ishfIFmh43Ghf3Wjaug/m12KKkzzTvhCuVvaHbQWtNgnm0F1c/Q4uDZ
eS1O1mYRhB/Q4sC06SWLtxc0PBe0OKT5T/1cWNcH4X9ocajt0d7EfaoR6v9W
h1JO/7L0A4VQ/7c6rFl7xdslJAnq/1YHJpnbCmePBkD93+agd2Nlz6FQe6j/
2xzCxDqnbn4jA/V/mwMDMlBod3jCx7az3OOzHcT/7Q7acz+/kTv80g4AnrPC
CA==
         "]]}, {
        Hue[0.3224758424985268, 0.6, 0.6], 
        Directive[
         PointSize[
          NCache[
           Rational[1, 90], 0.011111111111111112`]], 
         RGBColor[1, 0.75, 0], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYPSh0KV3Jw6DydaA/mN5Q5WKk8bG55MxXCVyh3
YJm/8/+dzzMh/APlDorTmqd1bZgL4SdUOBximb5fy3EBhM9Q6WCz9QCb9hwo
f0Glg9rqhN/1ClC+Q5VDzuaTxock5kH4D6oc+By0XZZ/ng21v9ohYOOjc+1K
s6D21zgIb/buFv43A2p/jcP0nqSlQjemQ+2vdZB6Vnbdd8c0qP11DvNfegSk
5k+B2l/nMG/vCbmmO5Og9tc7sPdFbprvCuU/qHfwbbzxnU9lMlS+wUFSwMgs
bSrU/xMaHB7Zv3nvnwb1/wMgf8m5z7nV8yF8g0aHte5Snjs3LoK6v9GhPXTF
4137lkD4FxodjryYE7Y7cCnUP00OXz7az2/hXwbhFzQ5NPcuTfF5sxzqvyYH
rzvlmzK5VkH4As0OnxckChyIWQ31b7PDFJV4HWN2KH9Ds8PqbVbHhJhWQP3f
4qBUsXv13D1Q9wS0OGybvvbfvn9Q9y9ocZDmld0V0tYP4X9ocdh6zPPq7cgm
qP9bHWQXfTdr+1MI9X+rg9vraYtXHk6C+r/V4eHjfEsX9yCo/9scXK56Pt3+
ygHq/zaHgrqnvLmhelD/tzmwJhY+FWXggfq/3YEBGRS0O9xZV/FRTE7QHgBm
C8z6
         "]]}}}, {{}, {{}, {}}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {341.6666666666674, 0}, 
     DisplayFunction :> Identity, Frame -> {{True, True}, {True, True}}, 
     FrameLabel -> {{
        FormBox[
         TagBox["\"Abs\"", HoldForm], TraditionalForm], None}, {
        FormBox[
         TagBox["\"Wavelength (nm)\"", HoldForm], TraditionalForm], None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
       "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
       "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           Identity[
            Part[#, 1]], 
           Identity[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{341.6666666666674, 750.}, {0, 0.06931214042148719}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.08090169943749476]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "4.75`", "5.5`", "7.55`", "8.33`", "9.41`", "11.23`", "11.9`", 
       "12.16`"}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #6}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.363898, 0.618501, 0.782349], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #7}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[1, 0.75, 0], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #8}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.922526, 0.385626, 0.209179]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.528488, 0.470624, 0.701351]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.772079, 0.431554, 0.102387]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.363898, 0.618501, 0.782349]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", 
                    FractionBox["1", "90"], "]"}], ",", 
                   
                   TemplateBox[<|"color" -> RGBColor[1, 0.75, 0]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5, ",", #6, ",", #7, 
               ",", #8}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "True", ",", "True", ",", "True", ",", "True", ",", "True", 
                 ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.89870182411477*^9, 3.898702259588689*^9},
 CellLabel->
  "Out[419]=",ExpressionUUID->"bbb74abd-5af6-4fa7-b736-64867ffa2d33"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Aside:  How well would our old classifiers work if we use the normalized data \
instead?\
\>", "Subsection",
 CellChangeTimes->{{3.8986968494416*^9, 3.8986968607896748`*^9}, {
  3.898696935056149*^9, 
  3.898696940664225*^9}},ExpressionUUID->"862e8b33-a5b1-4e5f-bd2a-\
0fc973c9a7c2"],

Cell["\<\
We had noted earlier that the spectra did not appear to have a consistent \
baseline.  What happens if we use the normalization described above?\
\>", "Text",
 CellChangeTimes->{{3.898697050255637*^9, 3.8986970538558702`*^9}, {
  3.898701375643708*^9, 
  3.8987013905230093`*^9}},ExpressionUUID->"a5a1af36-55e3-4736-a190-\
69f8082e23fc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"crossValidate", "[", 
   RowBox[{"normalizedData", ",", "\"\<LinearRegression\>\""}], "]"}], 
  ";"}], "\n", 
 RowBox[{"MeanAround", "/@", 
  RowBox[{"Transpose", "@", 
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.898696787019874*^9, 3.8986967931170692`*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"210d4abb-8e35-4576-9dd0-0af58886d91f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"0.60", "0.13"},
     "Around"],
    Around[0.5970337342508432, 0.13281249137081486`]], ",", 
   InterpretationBox[
    TemplateBox[{"0.85", "0.08"},
     "Around"],
    Around[0.852010631565939, 0.07532456059524129]]}], "}"}]], "Output",
 CellChangeTimes->{3.898696800503396*^9, 3.898702265541045*^9},
 CellLabel->
  "Out[421]=",ExpressionUUID->"070557dd-e47a-4057-ae10-126987575ffe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"crossValidate", "[", 
   RowBox[{"normalizedData", ",", "\"\<NearestNeighbors\>\""}], "]"}], 
  ";"}], "\n", 
 RowBox[{"MeanAround", "/@", 
  RowBox[{"Transpose", "@", 
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.898696821203635*^9, 3.898696834477932*^9}},
 CellLabel->
  "In[422]:=",ExpressionUUID->"e2623aa0-5a00-4d2f-b87c-a61e6a214e8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"0.58", "0.08"},
     "Around"],
    Around[0.5756785740755549, 0.08378407691521367]], ",", 
   InterpretationBox[
    TemplateBox[{"0.76", "0.09"},
     "Around"],
    Around[0.7595812836735119, 0.08612616283625377]]}], "}"}]], "Output",
 CellChangeTimes->{{3.8986968249353228`*^9, 3.898696837207121*^9}, 
   3.898702267900365*^9},
 CellLabel->
  "Out[423]=",ExpressionUUID->"822118c1-0568-46a9-8327-8bd8ac203456"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Comment:",
  FontWeight->"Bold"],
 " This appears to improve the models, and the model are now getting closer \
to the optimal transport value)"
}], "Text",
 CellChangeTimes->{{3.898697046607726*^9, 3.898697047800156*^9}, {
  3.898697157727853*^9, 3.898697207487542*^9}, {3.898697238543297*^9, 
  3.898697240575169*^9}, {3.898702442607435*^9, 3.8987024600952578`*^9}, {
  3.898702533454596*^9, 
  3.898702535782446*^9}},ExpressionUUID->"c8bfb144-2366-4171-a92a-\
a019ae91df31"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Aside: What if we PCA transform the normalized data and then use a standard \
regression model?\
\>", "Subsection",
 CellChangeTimes->{{3.898696948528222*^9, 3.898696954575881*^9}, {
  3.898697030543394*^9, 
  3.898697075664034*^9}},ExpressionUUID->"ce88cc25-4ffb-4ed8-8eab-\
1e4410216dd0"],

Cell["What if we use this normalized data as the input to PCA? ", "Text",
 CellChangeTimes->{{3.898701521854822*^9, 
  3.898701528406815*^9}},ExpressionUUID->"788c3f39-bfd2-4da3-9f77-\
4ece6d814207"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pca2", "=", 
  RowBox[{"DimensionReduction", "[", 
   RowBox[{
    RowBox[{"normalizedData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"Method", "->", "\"\<PrincipalComponentsAnalysis\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pca2Data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"pca2", "[", 
        RowBox[{"entry", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "->", 
       RowBox[{"entry", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ")"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"entry", ",", " ", "normalizedData"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.898696967608329*^9, 3.898697000784672*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"8374c170-5150-4211-b79e-6d52e4dfab38"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["DimensionReducerFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{{{{}, {}}, {}, {{}, {}, {
                 GrayLevel[0.7], 
                 AbsoluteThickness[1.8], 
                 Opacity[1.], 
                 LineBox[CompressedData["
1:eJwB8QEO/iFib1JlAgAAAB4AAAACAAAAAAAAAAAAAAAAAAAAAAAAAA3l5opg
ldw/ifaD+DItuD+MkCEodiHjP9qvjCs8v9E/bLbqGG2J5D+WRNoAzOrePxWI
hjT6cuM/qFFV1TM75j8YmI/Y7IHfP/eKfiNPOe0/quVYmD5o1D+ADmRmEGnx
P3eNjU0+TbI/IY3cLB+l8z/z/SDb3KDLv5a/pk3oyvQ/P80MS7g64L+H2H4K
a8b0P9+nsKVohOq/rTamnQZ68z/qrFzHBdfxv6YHIajkDPE/bw9qE5vX9b+Z
SUCP/i3rP/uMEvTgV/m/kzjs/r2F4T/bUNnDc5T7v9G7+cvEhMs/wYIqip+q
/L9jvEi/XoXHvxhoDlvsO/y/eOnDDXz84r8s6yb5EW/6v2qTREHJFe+/UEHO
hnD69r/GEyuZBq31v4JWinxOcPK/c9vQT8is+r8XVSwtro/ov0knBpVW9/6/
yZ09iVcE1b9l2NyAUeAAwDbV0T76Ar4/Y701SKBwAcCmV9X1r7fjP9Pdwu5B
LgHAhEmFnNot8T/aVnzNXBkAwIeJGWTe4Pc/Fl/LTVCK/L9n/YLkNTv+P27f
ThBa+/a/DjFFsd98AUAQoc+DuIDwv00y1JUAQgNAdLxOLvHB4L8FJ/Yfkw0E
QHdYowipHsa8z+n67g==
                  "]]}}, {}, {{{}, {}, {}, {}}, {}}}, {{{}, {}}, {}, {{}, 
                GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQvSOde+X6LwX2L+JEV934or//a9ba9rVPHto/qNs+
h/vZZfumRXKlmjWP7f94fAgTnPDcnk/kyM/O5Bf27XmKKav2f7HfXXOp8OzR
U/ZfddfwhpR8tH/Mf1NimfrD/bmrPms6/Ptsv6/iJO/vs5/3+3H82Z7G+Nqe
6/yMbVMP/dhfKsm+/u3U5/bzr9z7quHMeMBGKvy71POz+5PZdsQbTf23/7d6
VqJF6pf9/teV3u88/Hn/ux/vv2b//bTftGfJ25NKr/eXHb7jHVj0Y39nSUKD
+sIl9od7wyt357EeyI75vbEl+Jl9xCWXx0L8f/a7XHD6XCLA4HD6j8KD5/N+
7l/dca7ELo3ZwUXo+W6J9/f2j3T/AwAmeB/L
                 "], {{}, {
                   GrayLevel[0.5], 
                   PointSize[0.12], 
                   AbsoluteThickness[1.6], 
                   
                   PointBox[{17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
                    29, 30, 31, 
                    32}]}, {}}], {}}, {}, {}, {{{}, {}, {}, {}}, {}}}}, 
             ImagePadding -> 0.2, PlotRange -> {{-3.1, 3.2}, {-3.5, 2.1}}, 
             PlotRangePadding -> Automatic, PlotRangeClipping -> True, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]], Axes -> False, AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Input type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TemplateBox[{"\"NumericalVector\"", 
                    StyleBox[
                    TemplateBox[{"\" (\"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "41"}, 
                    "RowWithSeparators"], "\")\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Output dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{{{{}, {}}, {}, {{}, {}, {
                 GrayLevel[0.7], 
                 AbsoluteThickness[1.8], 
                 Opacity[1.], 
                 LineBox[CompressedData["
1:eJwB8QEO/iFib1JlAgAAAB4AAAACAAAAAAAAAAAAAAAAAAAAAAAAAA3l5opg
ldw/ifaD+DItuD+MkCEodiHjP9qvjCs8v9E/bLbqGG2J5D+WRNoAzOrePxWI
hjT6cuM/qFFV1TM75j8YmI/Y7IHfP/eKfiNPOe0/quVYmD5o1D+ADmRmEGnx
P3eNjU0+TbI/IY3cLB+l8z/z/SDb3KDLv5a/pk3oyvQ/P80MS7g64L+H2H4K
a8b0P9+nsKVohOq/rTamnQZ68z/qrFzHBdfxv6YHIajkDPE/bw9qE5vX9b+Z
SUCP/i3rP/uMEvTgV/m/kzjs/r2F4T/bUNnDc5T7v9G7+cvEhMs/wYIqip+q
/L9jvEi/XoXHvxhoDlvsO/y/eOnDDXz84r8s6yb5EW/6v2qTREHJFe+/UEHO
hnD69r/GEyuZBq31v4JWinxOcPK/c9vQT8is+r8XVSwtro/ov0knBpVW9/6/
yZ09iVcE1b9l2NyAUeAAwDbV0T76Ar4/Y701SKBwAcCmV9X1r7fjP9Pdwu5B
LgHAhEmFnNot8T/aVnzNXBkAwIeJGWTe4Pc/Fl/LTVCK/L9n/YLkNTv+P27f
ThBa+/a/DjFFsd98AUAQoc+DuIDwv00y1JUAQgNAdLxOLvHB4L8FJ/Yfkw0E
QHdYowipHsa8z+n67g==
                  "]]}}, {}, {{{}, {}, {}, {}}, {}}}, {{{}, {}}, {}, {{}, 
                GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQvSOde+X6LwX2L+JEV934or//a9ba9rVPHto/qNs+
h/vZZfumRXKlmjWP7f94fAgTnPDcnk/kyM/O5Bf27XmKKav2f7HfXXOp8OzR
U/ZfddfwhpR8tH/Mf1NimfrD/bmrPms6/Ptsv6/iJO/vs5/3+3H82Z7G+Nqe
6/yMbVMP/dhfKsm+/u3U5/bzr9z7quHMeMBGKvy71POz+5PZdsQbTf23/7d6
VqJF6pf9/teV3u88/Hn/ux/vv2b//bTftGfJ25NKr/eXHb7jHVj0Y39nSUKD
+sIl9od7wyt357EeyI75vbEl+Jl9xCWXx0L8f/a7XHD6XCLA4HD6j8KD5/N+
7l/dca7ELo3ZwUXo+W6J9/f2j3T/AwAmeB/L
                 "], {{}, {
                   GrayLevel[0.5], 
                   PointSize[0.12], 
                   AbsoluteThickness[1.6], 
                   
                   PointBox[{17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
                    29, 30, 31, 
                    32}]}, {}}], {}}, {}, {}, {{{}, {}, {}, {}}, {}}}}, 
             ImagePadding -> 0.2, PlotRange -> {{-3.1, 3.2}, {-3.5, 2.1}}, 
             PlotRangePadding -> Automatic, PlotRangeClipping -> True, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]], Axes -> False, AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Input type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TemplateBox[{"\"NumericalVector\"", 
                    StyleBox[
                    TemplateBox[{"\" (\"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "41"}, 
                    "RowWithSeparators"], "\")\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Output dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"PrincipalComponentsAnalysis\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox[
                 "\"Number of training examples: \"", 
                  "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                 TagBox["36", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  DimensionReducerFunction[<|
   "ExampleNumber" -> 36, "Imputer" -> 
    MachineLearning`MLProcessor[
     "ImputeMissing", <|
      "Invertibility" -> "Perfect", "Missing" -> "Imputed", 
       "StructurePreserving" -> True, 
       "Input" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>, 
       "Fill" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACz+aQkPb2UP0l1KlpkJpg/LSuohkJbnD98
jxH9fy+gP8xJ6O906qE/YaZXu6/Ioj851/L4WBSjP6u7mKwG4aI/KXurDu9b
oj/h8rXC8NehP6ksdLE8RKE/+vVhqMOQoD+QVA+NtO+eP/6tztrh2Js/eVLL
4qlcmT8da6Uql86XPymqp1rMzpc/wVlB3lMcmT+KHCFOKKqbP90bCtQMC6A/
+8ua3JJRoj95Qvwl81ajP8toKMBaSKI/tHW4PnR0oT9ghMmWftKhP/VssYry
FKM/iuFCQxEYpD/pgblP1v+jP061/gH97aE/iKjy/EpbnD+ZWFu35tqTP1m3
GUw8Uog/h3zXD1OifD86IfTdekZtP6V85FylgmA/X6YjG1zdUD+NJped1oJD
P5rE/OeakjU/nHrGdOYrJD/TOF/LSmIiPyudi9UENCY/Hv+mDQ==
        "], "Method" -> "Naive", "VectorLength" -> 41, 
       "Output" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>,
        "Type" -> "NumericalVector"|>], "RandomImputer" -> 
    MachineLearning`MLProcessor[
     "ImputeMissing", <|
      "Invertibility" -> "Perfect", "Missing" -> "Imputed", 
       "StructurePreserving" -> True, 
       "Input" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>, 
       "Mean" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACz+aQkPb2UP0l1KlpkJpg/LSuohkJbnD98
jxH9fy+gP8xJ6O906qE/YaZXu6/Ioj851/L4WBSjP6u7mKwG4aI/KXurDu9b
oj/h8rXC8NehP6ksdLE8RKE/+vVhqMOQoD+QVA+NtO+eP/6tztrh2Js/eVLL
4qlcmT8da6Uql86XPymqp1rMzpc/wVlB3lMcmT+KHCFOKKqbP90bCtQMC6A/
+8ua3JJRoj95Qvwl81ajP8toKMBaSKI/tHW4PnR0oT9ghMmWftKhP/VssYry
FKM/iuFCQxEYpD/pgblP1v+jP061/gH97aE/iKjy/EpbnD+ZWFu35tqTP1m3
GUw8Uog/h3zXD1OifD86IfTdekZtP6V85FylgmA/X6YjG1zdUD+NJped1oJD
P5rE/OeakjU/nHrGdOYrJD/TOF/LSmIiPyudi9UENCY/Hv+mDQ==
        "], "StandardDeviation" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAAC4bbzvLUBxPwiKWx0sdm4/ljbng35dcD/6
1iwcuE10P1UPFiQTS3w/0zT8QHdMgj+ZwxzSXumGPxWhD4Fydos/boadjuTa
jT9GgbrOvUyPP3EEUXE0oI4/YS7LOZP8jD9uofa4EjWKP7Wx8QJT1oY//pYO
+AmshD8NQZlrTC6DP7ZLenCw5II/e4msFVoIgz8tvYqWAlaDP1C2HXg55oY/
Jz+pn//riz+3if0Ta7CMPx8R2rn82Ig/0CGJaLapiT/r4V5/vniOP7GvXazB
SZE/7uqy2Vqfkj/8IeqF/a2SP32t8lAwsJA/ZSntBm4+ij/j/QTN7WOCP9xT
z3W+wXU/6Uo1bZsTaD9VXxr71mdYP80DJ81H80w/e8rtR5DlOj/XWidwxKo3
P+cs/IaTGz4/uGNcXz7LLD8SopoHm1hCP/Gf2qnx/EE/eSie2w==
        "], "Method" -> "NaiveSampler", "VectorLength" -> 41, 
       "Output" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>,
        "Type" -> "NumericalVector"|>], "Preprocessor" -> 
    MachineLearning`MLProcessor[
     "ToMLDataset", <|
      "Input" -> <|"f1" -> <|"Type" -> "NumericalVector", "Length" -> 41|>|>, 
       "Output" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>,
        "Preprocessor" -> 
       MachineLearning`MLProcessor["Sequence", <|"Processors" -> {
            MachineLearning`MLProcessor["List"], 
            MachineLearning`MLProcessor[
            "WrapMLDataset", <|
             "FeatureTypes" -> {"NumericalVector"}, "FeatureKeys" -> {"f1"}, 
              "FeatureWeights" -> Automatic, "ExampleWeights" -> Automatic, 
              "RawExample" -> Missing["KeyAbsent", "RawExample"], 
              "StructurePreserving" -> False|>]}|>], "ScalarFeature" -> True, 
       "Invertibility" -> "Perfect", "StructurePreserving" -> False, 
       "Missing" -> "Allowed"|>], "Processor" -> 
    MachineLearning`MLProcessor["Identity"], 
    "Model" -> <|"Matrix" -> CompressedData["
1:eJwBoQJe/SFib1JlAgAAACkAAAACAAAAMEP0oxxtyD+WoqQ1n+6Dv9J9YjhE
E8c/JnGkjPpXuL9sBzmsRfnEP/F1wHOAdMO/+PcsWOqxwz8ZVbue3ODHv6Wp
e2s/VsM/eJhg0ffYyr+jPgb6DVbFPw19tOcg18W/RAQlk4h1xj9EbLcQvmrC
v87c+/6kWMc/SlBj7uZtvr+zkYgrrePHP6DzY35rP7m/MjADHGBQyD8MU4vR
2Bm0v2NFXF6zisg/wPdbp7jnsL/fw488vdXIPw647neExqK/0aEqWWbzyD+E
xb8Ntehlv7BnsQ2biMg/jWoSGfrtqj9o745RfcLGP3H8DroCN8A/fpA6gqhN
wz8QcNCA53DJP7htykV247s/Y5Wa+Xrl0D+QMLUtY/qtPxhRf1xeiNM/3dMv
SqLBbb9ZfvZ5oQ3UP+LqhDwlx7K/AqmauXfA0T+9l3sCK927v/B+IAZOz80/
rPAc0xPkwb+6Az3ZDbvHPzRX1H+yvMa/WwycQ+b9vD8YVpsv1wDJv+B59aIt
L4Y/uGzejmCcyL8f6TQ4x5auvyHG0Yz0Oci/QuKrjESDs782N4rIefXHv3D3
Jxe+o7a/LismOFG/x7/FyX3Ov3G4v7VWs0Akjce/yw5hdgj6ub+utsRF+2PH
v3fn9C1jzLq/ZFXaf9Eix798lUuZ8mW9v9Ep2pHpK8e/vZxSLkv1ub++QUyH
aOLGv3ZnEmmBSrm/QJwa6mdAxr/i5eW2WRXCv5h7xTIoxru/6Rh/0zHMtD8D
y4bCNxexvzuM0p2KtbY/XR5S59FopT+vw1KSsFnHP0VadrN1Y6s/GCsAxeQi
yz+sBj6LBLqyPwdur/nvdsY/AmLlyFQZqz8bwiZUywfLP/UEpIIPrq4/1keI
ssOIyD8uzWIS
       "], "Processor" -> 
      MachineLearning`MLProcessor[
       "Sequence", <|
        "Input" -> <|"f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>,
          "Output" -> <|
          "f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>, 
         "Processors" -> {
           MachineLearning`MLProcessor[
           "Standardize", <|
            "Invertibility" -> "Perfect", "Missing" -> "Allowed", 
             "StructurePreserving" -> True, 
             "Input" -> <|
              "f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>, 
             "Mean" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACz+aQkPb2UP0l1KlpkJpg/LSuohkJbnD98
jxH9fy+gP8xJ6O906qE/YaZXu6/Ioj851/L4WBSjP6u7mKwG4aI/KXurDu9b
oj/h8rXC8NehP6ksdLE8RKE/+vVhqMOQoD+QVA+NtO+eP/6tztrh2Js/eVLL
4qlcmT8da6Uql86XPymqp1rMzpc/wVlB3lMcmT+KHCFOKKqbP90bCtQMC6A/
+8ua3JJRoj95Qvwl81ajP8toKMBaSKI/tHW4PnR0oT9ghMmWftKhP/VssYry
FKM/iuFCQxEYpD/pgblP1v+jP061/gH97aE/iKjy/EpbnD+ZWFu35tqTP1m3
GUw8Uog/h3zXD1OifD86IfTdekZtP6V85FylgmA/X6YjG1zdUD+NJped1oJD
P5rE/OeakjU/nHrGdOYrJD/TOF/LSmIiPyudi9UENCY/Hv+mDQ==
              "], "StandardDeviation" -> CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAAC4bbzvLUBxPwiKWx0sdm4/ljbng35dcD/6
1iwcuE10P1UPFiQTS3w/0zT8QHdMgj+ZwxzSXumGPxWhD4Fydos/boadjuTa
jT9GgbrOvUyPP3EEUXE0oI4/YS7LOZP8jD9uofa4EjWKP7Wx8QJT1oY//pYO
+AmshD8NQZlrTC6DP7ZLenCw5II/e4msFVoIgz8tvYqWAlaDP1C2HXg55oY/
Jz+pn//riz+3if0Ta7CMPx8R2rn82Ig/0CGJaLapiT/r4V5/vniOP7GvXazB
SZE/7uqy2Vqfkj/8IeqF/a2SP32t8lAwsJA/ZSntBm4+ij/j/QTN7WOCP9xT
z3W+wXU/6Uo1bZsTaD9VXxr71mdYP80DJ81H80w/e8rtR5DlOj/XWidwxKo3
P+cs/IaTGz4/uGNcXz7LLD8SopoHm1hCP/Gf2qnx/EE/eSie2w==
              "], 
             "Output" -> <|
              "f1" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>|>|>], 
           MachineLearning`MLProcessor[
           "FirstValues", <|
            "Info" -> <|"Type" -> "NumericalVector", "Weight" -> 1|>, "Key" -> 
             "f1", "Invertibility" -> "Perfect", "StructurePreserving" -> 
             False, "Missing" -> "Allowed"|>]}, "Invertibility" -> "Perfect", 
         "StructurePreserving" -> False, "Missing" -> "Allowed"|>], 
      "FinalDimension" -> 2, "Padder" -> 
      MachineLearning`MLProcessor["Identity"], "Method" -> 
      "PrincipalComponentsAnalysis"|>, "PerformanceGoal" -> Automatic, 
    "Invertibility" -> "Approximate", 
    "Log" -> <|
     "TrainingTime" -> 0.014755, "MaxTrainingMemory" -> 129592, "DataMemory" -> 
      17904, "FunctionMemory" -> 24824, "LanguageVersion" -> {13.2, 0}, 
      "Date" -> DateObject[{2023, 7, 18, 16, 51, 7.957803`7.653368170983906}, 
        "Instant", "Gregorian", -4.], "ProcessorCount" -> 4, "ProcessorType" -> 
      "x86-64", "OperatingSystem" -> "MacOSX", "SystemWordLength" -> 64, 
      "Evaluations" -> {}|>|>],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.898697003622643*^9, 3.898702267976783*^9},
 CellLabel->
  "Out[424]=",ExpressionUUID->"5379c3c4-0473-4098-afc4-b727da1c1670"]
}, Open  ]],

Cell["Re-run the model generation and cross validation:", "Text",
 CellChangeTimes->{{3.898701537938908*^9, 
  3.898701551766519*^9}},ExpressionUUID->"131973ce-f64c-41cd-8fef-\
8947d8eecfdb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"crossValidate", "[", 
   RowBox[{"pca2Data", ",", "\"\<LinearRegression\>\""}], "]"}], ";"}], "\n", 

 RowBox[{
  RowBox[{"MeanAround", "/@", 
   RowBox[{"Transpose", "@", 
    RowBox[{"%", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"crossValidate", "[", 
   RowBox[{"pca2Data", ",", "\"\<NearestNeighbors\>\""}], "]"}], 
  ";"}], "\n", 
 RowBox[{"MeanAround", "/@", 
  RowBox[{"Transpose", "@", 
   RowBox[{"%", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "\"\<ValidationResult\>\""}], "]"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8986970126000423`*^9, 3.8986970232164507`*^9}},
 CellLabel->
  "In[426]:=",ExpressionUUID->"8848dd94-9c4e-48c5-b638-fd4a0d97d727"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"1.45", "0.09"},
     "Around"],
    Around[1.453906982467481, 0.09057798710304954]], ",", 
   InterpretationBox[
    TemplateBox[{"0.44", "0.19"},
     "Around"],
    Around[0.4363407234515863, 0.1865202149832086]]}], "}"}]], "Output",
 CellChangeTimes->{3.898697029226863*^9, 3.898702273725801*^9},
 CellLabel->
  "Out[427]=",ExpressionUUID->"55af246d-adfe-4029-bab5-9a99ea66fb82"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"0.57", "0.12"},
     "Around"],
    Around[0.5721071346103764, 0.11653741914356015`]], ",", 
   InterpretationBox[
    TemplateBox[{"0.85", "0.07"},
     "Around"],
    Around[0.8454372357123494, 0.06868847115524494]]}], "}"}]], "Output",
 CellChangeTimes->{3.898697029226863*^9, 3.89870227660036*^9},
 CellLabel->
  "Out[429]=",ExpressionUUID->"c9ba14e9-f983-47d3-9bb1-b12dde396cf6"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Comment:",
  FontWeight->"Bold"],
 "  This slightly (probably not meaningfully) improves the nearest neighbor \
metric, but makes the linear model worse; we could play around with other \
dimensional embeddings if desired, but this does not seem promising."
}], "Text",
 CellChangeTimes->{{3.8986970875036097`*^9, 3.898697151903524*^9}, {
  3.898697212823448*^9, 3.898697234815455*^9}, {3.8987015549985847`*^9, 
  3.898701608766555*^9}, {3.898702490846581*^9, 
  3.8987025585741167`*^9}},ExpressionUUID->"643c0b05-8e1b-4df4-a98f-\
756b1e155f49"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Discussion items and next steps", "Section",
 CellChangeTimes->{{3.898701612342209*^9, 
  3.8987016343579597`*^9}},ExpressionUUID->"f85d76b2-b1ca-4a4d-8500-\
d7a09779c8c7"],

Cell["Discuss proper approach to blanking and normalization.", "Item",
 CellChangeTimes->{{3.898701973187189*^9, 3.898701975515183*^9}, {
   3.898702041594599*^9, 3.898702058242495*^9}, 
   3.898703717940598*^9},ExpressionUUID->"ae32d627-9d40-4004-be7b-\
1c8319327bd6"],

Cell["\<\
Is +/-0.5 pH units good enough?  If so, then I recommend proceeding with the \
earthmover distance based metric \
\>", "Item",
 CellChangeTimes->{{3.898701973187189*^9, 3.898701975515183*^9}, {
  3.898702041594599*^9, 3.8987020688983803`*^9}, {3.898703168665069*^9, 
  3.898703197921042*^9}},ExpressionUUID->"8ee37af5-8535-46b3-99bf-\
14f9fe4fecf8"],

Cell["\<\
It would be useful to acquire another batch of data (perhaps even the \
\[OpenCurlyDoubleQuote]same\[CloseCurlyDoubleQuote] experiments) to be able \
to assess variations between different experiment conditions (running on a \
different day, different plate, etc.)\
\>", "Item",
 CellChangeTimes->{{3.898701973187189*^9, 3.898701975515183*^9}, {
  3.898702041594599*^9, 3.8987020688983803`*^9}, {3.898703168665069*^9, 
  3.8987032500716267`*^9}},ExpressionUUID->"2217f26d-046a-43f2-85b3-\
23517f8b3626"],

Cell["\<\
My understanding is that these are still very \[OpenCurlyDoubleQuote]clean\
\[CloseCurlyDoubleQuote] systems; we may wish to try adding impurities to see \
the extent to which they screw up the spectra.\
\>", "Item",
 CellChangeTimes->{{3.898701973187189*^9, 3.898701975515183*^9}, {
  3.898702041594599*^9, 3.8987020688983803`*^9}, {3.898703168665069*^9, 
  3.8987032495286493`*^9}, {3.8987036358610783`*^9, 3.898703646236684*^9}, {
  3.898703698101223*^9, 
  3.898703715284519*^9}},ExpressionUUID->"9c35f14f-9453-4697-ab70-\
2d98c620af24"],

Cell["\<\
What\[CloseCurlyQuote]s the right way to deploy this for the intended science \
goals? \
\>", "Item",
 CellChangeTimes->{{3.898701973187189*^9, 3.898701975515183*^9}, {
  3.898702041594599*^9, 3.8987020688983803`*^9}, {3.898703168665069*^9, 
  3.8987032495286493`*^9}, {3.8987036358610783`*^9, 
  3.898703666012808*^9}},ExpressionUUID->"8bac6c70-da65-4d31-9686-\
8f9d9f9afe89"]
}, Open  ]]
},
WindowSize->{1206, 953},
WindowMargins->{{81, Automatic}, {Automatic, 102}},
PrivateNotebookOptions->{"CloudPublishPath"->"/Published/2023.07.18_pH_\
spectroscopy.nb"},
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"de431d82-19d9-4c52-80d3-bbc78205b5f8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 158, 3, 67, "Section",ExpressionUUID->"41bfdf1c-cbae-498c-b0ba-4ef64f7ba1eb"],
Cell[741, 27, 337, 7, 35, "Text",ExpressionUUID->"4815a82b-fa12-4ff9-8213-9f53b7e54dc4"],
Cell[1081, 36, 706, 15, 74, "Input",ExpressionUUID->"8ff1613a-309d-4d85-a065-e5221190e944"],
Cell[CellGroupData[{
Cell[1812, 55, 1114, 25, 136, "Input",ExpressionUUID->"b10ec20e-4824-43de-84fb-c506e6068098"],
Cell[2929, 82, 994, 24, 48, "Output",ExpressionUUID->"8a64bf13-c246-4f35-b45d-25a39301ed38"],
Cell[3926, 108, 943, 17, 56, "Output",ExpressionUUID->"738dcff2-6385-4e5f-ad50-dad829045876"]
}, Open  ]],
Cell[4884, 128, 1184, 32, 94, "Input",ExpressionUUID->"dd4d6e42-867a-4aa9-8329-2ebc0d0b79b9"],
Cell[CellGroupData[{
Cell[6093, 164, 211, 3, 54, "Subsection",ExpressionUUID->"74c51757-cb74-4072-8f7a-3cf6412c4647"],
Cell[CellGroupData[{
Cell[6329, 171, 1933, 45, 157, "Input",ExpressionUUID->"cef8418b-1cb4-4a84-91ef-ecb660a027c0"],
Cell[8265, 218, 26469, 590, 255, "Output",ExpressionUUID->"13a56737-c31a-4c7b-8836-cd4686ba8b26"]
}, Open  ]],
Cell[34749, 811, 721, 13, 58, "Text",ExpressionUUID->"dd48f216-ab0c-44a6-9b7c-0887d2ca7c1b"],
Cell[CellGroupData[{
Cell[35495, 828, 1068, 27, 157, "Input",ExpressionUUID->"51e6fb90-14c8-4107-a5df-413c27bbe62e"],
Cell[36566, 857, 13748, 313, 255, "Output",ExpressionUUID->"3c70c2c3-43f8-49ae-9fd9-858d3825f656"]
}, Open  ]],
Cell[50329, 1173, 406, 10, 35, "Text",ExpressionUUID->"f4bacee1-9bea-4acf-9daa-20ef0e2f3f49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50772, 1188, 167, 3, 54, "Subsection",ExpressionUUID->"ea0c463e-3d23-4dfd-8556-6140c0a2da85"],
Cell[50942, 1193, 310, 7, 35, "Text",ExpressionUUID->"3e986cfb-1dd9-4fd4-9fb8-984250747ed5"],
Cell[CellGroupData[{
Cell[51277, 1204, 1234, 32, 136, "Input",ExpressionUUID->"f4abb5b8-c588-4acf-afbd-dabf3b236061"],
Cell[52514, 1238, 6411, 154, 248, "Output",ExpressionUUID->"d26c1a07-accc-4e6f-8764-f5ec270f4d2f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58986, 1399, 238, 4, 67, "Section",ExpressionUUID->"eb37714b-2f62-455e-8a4b-ccbbb3b3df22"],
Cell[59227, 1405, 341, 7, 35, "Text",ExpressionUUID->"33ec8577-5af7-49a3-8353-ca3cd3d1f24d"],
Cell[CellGroupData[{
Cell[59593, 1416, 1008, 27, 52, "Input",ExpressionUUID->"f6e12f12-dbc5-4737-8b74-feb5aec1c4f5"],
Cell[60604, 1445, 17109, 332, 62, "Output",ExpressionUUID->"75b2bfb5-d2e2-4c7b-a0e8-05e93b255ba3"]
}, Open  ]],
Cell[77728, 1780, 223, 5, 35, "Text",ExpressionUUID->"765c7fce-fb3d-489a-8b1c-0045e6e965ec"],
Cell[77954, 1787, 882, 22, 115, "Input",ExpressionUUID->"90cfb06f-3599-429c-9ce9-08149cfca993"],
Cell[CellGroupData[{
Cell[78861, 1813, 1084, 27, 94, "Input",ExpressionUUID->"3322ca10-b9dd-4243-84b1-d731cb001f94"],
Cell[79948, 1842, 589, 15, 34, "Output",ExpressionUUID->"6dabefe0-ceff-472b-b6bb-854f50d03752"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80574, 1862, 692, 16, 52, "Input",ExpressionUUID->"145a2da5-fe48-4611-862f-325957bb5e56"],
Cell[81269, 1880, 509, 14, 34, "Output",ExpressionUUID->"32be7579-8128-453a-8681-de7d10cfb411"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81815, 1899, 582, 15, 52, "Input",ExpressionUUID->"6ab070d3-20f4-4fc5-a483-2dc4e1aaded5"],
Cell[82400, 1916, 515, 14, 34, "Output",ExpressionUUID->"0940c132-1a45-4937-b94c-de6fd1710f2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82952, 1935, 540, 14, 52, "Input",ExpressionUUID->"b58840e3-f9d5-4703-91b5-8851fdd211e3"],
Cell[83495, 1951, 517, 14, 34, "Output",ExpressionUUID->"f1884661-453d-4031-86ea-a609cdab4887"]
}, Open  ]],
Cell[84027, 1968, 625, 12, 58, "Text",ExpressionUUID->"d7a9b6a2-af6d-4743-9ba0-77b4a6d7ad96"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84689, 1985, 218, 5, 67, "Section",ExpressionUUID->"b8e6ecb3-874b-42ff-a200-970e8a25147b"],
Cell[84910, 1992, 613, 12, 58, "Text",ExpressionUUID->"f91d9ff0-26ce-45dc-a0f8-cdcf6645d84c"],
Cell[CellGroupData[{
Cell[85548, 2008, 1394, 35, 136, "Input",ExpressionUUID->"40f2a1e6-7c43-4bc2-be1e-506bccec506d"],
Cell[86945, 2045, 648, 16, 34, "Output",ExpressionUUID->"f175dd63-514b-4abe-80b7-ee3c3e7a473b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87642, 2067, 186, 3, 67, "Section",ExpressionUUID->"3cd55a60-d3fe-4071-a2d9-d4a5b429d367"],
Cell[87831, 2072, 734, 17, 150, "Text",ExpressionUUID->"c9196d79-53ca-43a6-9487-e44be5930ced"],
Cell[CellGroupData[{
Cell[88590, 2093, 162, 3, 54, "Subsection",ExpressionUUID->"f2b9c36f-52c2-4632-9eb9-eac4914d403b"],
Cell[88755, 2098, 359, 8, 35, "Text",ExpressionUUID->"4a5df680-31de-4a6a-8375-c5ae0415a814"],
Cell[89117, 2108, 1112, 31, 73, "Input",ExpressionUUID->"0c04f9c7-5577-45f5-94c0-e7b8208e179c"],
Cell[90232, 2141, 338, 7, 35, "Text",ExpressionUUID->"728ae7d6-f9cd-407a-8b38-b39c3acd0e22"],
Cell[CellGroupData[{
Cell[90595, 2152, 1180, 29, 178, "Input",ExpressionUUID->"6adb5dd1-563a-4d6f-8274-e0a5bea8f60b"],
Cell[91778, 2183, 13889, 315, 258, "Output",ExpressionUUID->"eec02082-0bf9-42d8-90e5-580f23235503"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105716, 2504, 228, 4, 54, "Subsection",ExpressionUUID->"97e098d5-df1b-4cd7-823a-b0780207db30"],
Cell[105947, 2510, 444, 10, 30, "Input",ExpressionUUID->"64a6599b-44de-44a7-be44-46e1146eee21"],
Cell[CellGroupData[{
Cell[106416, 2524, 3306, 79, 304, "Input",ExpressionUUID->"f28e6b96-6714-4946-8eee-87ffefc1f2ea"],
Cell[109725, 2605, 619, 15, 34, "Output",ExpressionUUID->"5cdb4814-e1c1-4596-86e3-19c8781fad58"]
}, Open  ]],
Cell[110359, 2623, 417, 9, 35, "Text",ExpressionUUID->"4056c1a5-8e06-488f-8437-d2ce553e8b5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110813, 2637, 230, 5, 54, "Subsection",ExpressionUUID->"01a11af8-fded-4574-9373-e7f84c52b465"],
Cell[111046, 2644, 238, 6, 35, "Text",ExpressionUUID->"4b50bf2c-34ad-43bb-88dd-a47983e311f9"],
Cell[CellGroupData[{
Cell[111309, 2654, 1584, 39, 178, "Input",ExpressionUUID->"24c55070-af87-4f2a-87d5-8bc3c85a4832"],
Cell[112896, 2695, 26140, 588, 252, "Output",ExpressionUUID->"bbb74abd-5af6-4fa7-b736-64867ffa2d33"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[139085, 3289, 293, 7, 54, "Subsection",ExpressionUUID->"862e8b33-a5b1-4e5f-bd2a-0fc973c9a7c2"],
Cell[139381, 3298, 347, 7, 35, "Text",ExpressionUUID->"a5a1af36-55e3-4736-a190-69f8082e23fc"],
Cell[CellGroupData[{
Cell[139753, 3309, 484, 13, 52, "Input",ExpressionUUID->"210d4abb-8e35-4576-9dd0-0af58886d91f"],
Cell[140240, 3324, 464, 13, 34, "Output",ExpressionUUID->"070557dd-e47a-4057-ae10-126987575ffe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140741, 3342, 482, 13, 52, "Input",ExpressionUUID->"e2623aa0-5a00-4d2f-b87c-a61e6a214e8d"],
Cell[141226, 3357, 494, 14, 34, "Output",ExpressionUUID->"822118c1-0568-46a9-8327-8bd8ac203456"]
}, Open  ]],
Cell[141735, 3374, 504, 11, 35, "Text",ExpressionUUID->"c8bfb144-2366-4171-a92a-a019ae91df31"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142276, 3390, 300, 7, 54, "Subsection",ExpressionUUID->"ce88cc25-4ffb-4ed8-8eab-1e4410216dd0"],
Cell[142579, 3399, 199, 3, 35, "Text",ExpressionUUID->"788c3f39-bfd2-4da3-9f77-4ece6d814207"],
Cell[CellGroupData[{
Cell[142803, 3406, 879, 25, 52, "Input",ExpressionUUID->"8374c170-5150-4211-b79e-6d52e4dfab38"],
Cell[143685, 3433, 17081, 331, 62, "Output",ExpressionUUID->"5379c3c4-0473-4098-afc4-b727da1c1670"]
}, Open  ]],
Cell[160781, 3767, 191, 3, 35, "Text",ExpressionUUID->"131973ce-f64c-41cd-8fef-8947d8eecfdb"],
Cell[CellGroupData[{
Cell[160997, 3774, 842, 24, 115, "Input",ExpressionUUID->"8848dd94-9c4e-48c5-b638-fd4a0d97d727"],
Cell[161842, 3800, 462, 13, 34, "Output",ExpressionUUID->"55af246d-adfe-4029-bab5-9a99ea66fb82"],
Cell[162307, 3815, 464, 13, 34, "Output",ExpressionUUID->"c9ba14e9-f983-47d3-9bb1-b12dde396cf6"]
}, Open  ]],
Cell[162786, 3831, 572, 11, 58, "Text",ExpressionUUID->"643c0b05-8e1b-4df4-a98f-756b1e155f49"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163407, 3848, 178, 3, 67, "Section",ExpressionUUID->"f85d76b2-b1ca-4a4d-8500-d7a09779c8c7"],
Cell[163588, 3853, 269, 4, 32, "Item",ExpressionUUID->"ae32d627-9d40-4004-be7b-1c8319327bd6"],
Cell[163860, 3859, 359, 7, 32, "Item",ExpressionUUID->"8ee37af5-8535-46b3-99bf-14f9fe4fecf8"],
Cell[164222, 3868, 513, 9, 53, "Item",ExpressionUUID->"2217f26d-046a-43f2-85b3-23517f8b3626"],
Cell[164738, 3879, 551, 10, 32, "Item",ExpressionUUID->"9c35f14f-9453-4697-ab70-2d98c620af24"],
Cell[165292, 3891, 387, 8, 32, "Item",ExpressionUUID->"8bac6c70-da65-4d31-9686-8f9d9f9afe89"]
}, Open  ]]
}
]
*)

